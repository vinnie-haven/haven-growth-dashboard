<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Haven Energy ‚Äî Growth Marketing Dashboard</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
<style>
  :root {
    --bg: #0a0f1a; --surface: #111827; --surface2: #1a2234; --border: #1e2d44;
    --text: #e2e8f0; --text-dim: #8896aa; --accent: #22d3a7; --accent2: #3b82f6;
    --accent3: #f59e0b; --purple: #a855f7; --pink: #ec4899; --red: #ef4444; --green: #22c55e;
    --font: 'DM Sans', sans-serif; --mono: 'Space Mono', monospace;
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  body { background:var(--bg); color:var(--text); font-family:var(--font); min-height:100vh; }
  .topbar { display:flex; align-items:center; justify-content:space-between; padding:16px 32px; border-bottom:1px solid var(--border); background:var(--surface); }
  .topbar-left { display:flex; align-items:center; gap:16px; }
  .logo { font-family:var(--mono); font-size:13px; font-weight:700; color:var(--accent); letter-spacing:2px; text-transform:uppercase; }
  .topbar-title { font-size:15px; font-weight:500; color:var(--text-dim); }
  .topbar-right { display:flex; align-items:center; gap:12px; }
  .sync-btn { background:var(--surface2); border:1px solid var(--border); color:var(--text-dim); font-family:var(--font); font-size:13px; padding:8px 16px; border-radius:8px; cursor:pointer; transition:all 0.2s; }
  .sync-btn:hover { border-color:var(--accent); color:var(--accent); }
  .sync-btn.syncing { color:var(--accent); border-color:var(--accent); opacity:0.7; cursor:wait; }
  .sync-status { font-family:var(--mono); font-size:11px; color:var(--text-dim); }
  .controls { display:flex; align-items:center; justify-content:space-between; padding:20px 32px; gap:16px; flex-wrap:wrap; }
  .toggle-group { display:flex; background:var(--surface); border-radius:10px; padding:3px; border:1px solid var(--border); }
  .toggle-group button { background:transparent; border:none; color:var(--text-dim); font-family:var(--font); font-size:13px; font-weight:500; padding:8px 20px; border-radius:8px; cursor:pointer; transition:all 0.2s; }
  .toggle-group button.active { background:var(--accent); color:#0a0f1a; font-weight:600; }
  .period-nav { display:flex; align-items:center; gap:12px; }
  .period-nav button { background:var(--surface); border:1px solid var(--border); color:var(--text); width:36px; height:36px; border-radius:8px; cursor:pointer; font-size:16px; transition:all 0.2s; display:flex; align-items:center; justify-content:center; }
  .period-nav button:hover { border-color:var(--accent); }
  .period-label { font-family:var(--mono); font-size:14px; font-weight:700; min-width:200px; text-align:center; }
  .filter-group { display:flex; align-items:center; gap:12px; }
  .exclude-toggle { display:flex; align-items:center; gap:8px; font-size:13px; color:var(--text-dim); }
  .exclude-toggle input { accent-color:var(--accent); width:16px; height:16px; }
  select { background:var(--surface2); border:1px solid var(--border); color:var(--text); font-family:var(--font); font-size:13px; padding:8px 12px; border-radius:8px; }
  .main { padding:0 32px 40px; }
  .tab-content { display:none; } .tab-content.active { display:block; }
  .kpi-grid { display:grid; grid-template-columns:repeat(6,1fr); gap:16px; margin-bottom:28px; }
  .kpi-card { background:var(--surface); border:1px solid var(--border); border-radius:14px; padding:20px; position:relative; overflow:hidden; transition:border-color 0.2s; }
  .kpi-card:hover { border-color:var(--accent); }
  .kpi-card::before { content:''; position:absolute; top:0; left:0; right:0; height:3px; }
  .kpi-card:nth-child(1)::before{background:var(--accent)} .kpi-card:nth-child(2)::before{background:var(--accent2)} .kpi-card:nth-child(3)::before{background:var(--accent3)} .kpi-card:nth-child(4)::before{background:var(--purple)} .kpi-card:nth-child(5)::before{background:var(--pink)} .kpi-card:nth-child(6)::before{background:#f43f5e}
  .kpi-label { font-size:12px; font-weight:600; text-transform:uppercase; letter-spacing:1px; color:var(--text-dim); margin-bottom:10px; }
  .kpi-value { font-family:var(--mono); font-size:32px; font-weight:700; line-height:1; margin-bottom:8px; }
  .kpi-change { font-family:var(--mono); font-size:12px; font-weight:700; } .kpi-change.up{color:var(--green)} .kpi-change.down{color:var(--red)} .kpi-change.flat{color:var(--text-dim)}
  .kpi-prev { font-size:11px; color:var(--text-dim); margin-top:2px; }
  .charts-grid { display:grid; grid-template-columns:1fr 1fr; gap:16px; margin-bottom:28px; }
  .chart-card { background:var(--surface); border:1px solid var(--border); border-radius:14px; padding:24px; }
  .chart-title { font-size:14px; font-weight:600; margin-bottom:16px; }
  .chart-container { position:relative; height:280px; }
  .funnel-stages{display:flex;flex-direction:column;gap:8px} .funnel-stage{display:flex;align-items:center;gap:10px} .funnel-stage-name{font-size:12px;font-weight:600;color:var(--text-dim);width:64px;text-align:right} .funnel-bar-wrap{flex:1;height:38px;background:var(--surface2);border-radius:8px;overflow:hidden} .funnel-bar{height:100%;border-radius:8px;transition:width .6s ease;display:flex;align-items:center;padding-left:12px;min-width:36px} .funnel-bar-label{font-family:var(--mono);font-size:12px;font-weight:700;color:#0a0f1a;white-space:nowrap} .funnel-arrow{text-align:center;color:var(--text-dim);font-size:11px;padding-left:74px;font-family:var(--mono)}
  .table-card { background:var(--surface); border:1px solid var(--border); border-radius:14px; padding:24px; overflow-x:auto; margin-bottom:28px; }
  .table-card table{width:100%;border-collapse:collapse} .table-card th{font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:1px;color:var(--text-dim);text-align:center;padding:10px 12px;border-bottom:1px solid var(--border)} .table-card th:first-child{text-align:left} .table-card td{padding:12px 12px;font-family:var(--mono);font-size:14px;border-bottom:1px solid var(--border);text-align:center} .table-card td:first-child{text-align:left} .table-card tr:last-child td{border-bottom:none} .table-card tr:hover td{background:var(--surface2)}
  .mini-bar{display:inline-block;height:6px;border-radius:3px;margin-right:8px;vertical-align:middle}
  .spend-kpi-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:16px;margin-bottom:28px}
  .sync-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(10,15,26,.85);display:flex;align-items:center;justify-content:center;z-index:100;opacity:0;pointer-events:none;transition:opacity .3s} .sync-overlay.show{opacity:1;pointer-events:all} .sync-modal{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:32px 40px;max-width:420px;width:90%;text-align:center} .sync-modal h3{font-size:16px;margin-bottom:16px} .sync-progress{font-family:var(--mono);font-size:13px;color:var(--accent);margin-bottom:8px} .sync-detail{font-size:12px;color:var(--text-dim);margin-bottom:16px} .sync-bar-track{height:6px;background:var(--surface2);border-radius:3px;overflow:hidden} .sync-bar-fill{height:100%;background:var(--accent);border-radius:3px;transition:width .3s}
  @media(max-width:1100px){.kpi-grid,.spend-kpi-grid{grid-template-columns:repeat(3,1fr)} .charts-grid{grid-template-columns:1fr}}
  @media(max-width:700px){.kpi-grid,.spend-kpi-grid{grid-template-columns:repeat(2,1fr)} .controls{flex-direction:column;align-items:flex-start} .topbar,.main,.controls{padding-left:16px;padding-right:16px}}
  #megaTable{font-size:13px} #megaTable th{font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:var(--text-dim);text-align:center;padding:8px 14px;border-bottom:1px solid var(--border);white-space:nowrap} #megaTable th:first-child{text-align:left;min-width:180px;position:sticky;left:0;background:var(--surface);z-index:1}
  #megaTable td{padding:8px 14px;font-family:var(--mono);font-size:13px;border-bottom:1px solid var(--border);text-align:center;white-space:nowrap} #megaTable td:first-child{text-align:left;font-family:var(--font);font-weight:500;position:sticky;left:0;background:var(--surface);z-index:1}
  #megaTable tr:hover td{background:var(--surface2)} #megaTable .section-row td{font-family:var(--font);font-weight:700;font-size:12px;text-transform:uppercase;letter-spacing:1px;color:var(--accent);padding-top:18px;border-bottom:2px solid var(--border);text-align:left;background:var(--bg)!important}
  .mega-wrap{overflow-x:auto;max-width:100%}
</style>
</head>
<body>
<div class="topbar"><div class="topbar-left"><div class="logo">Haven Energy</div><div class="topbar-title">Growth Marketing</div></div><div class="topbar-right"><button class="sync-btn" id="syncBtn" onclick="runSync()">‚ü≥ Sync HubSpot</button><span class="sync-status" id="syncStatus">Loading...</span></div></div>
<div class="controls">
  <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
    <div class="toggle-group" id="tabToggle"><button class="active" onclick="setTab('summary',this)">Summary</button><button onclick="setTab('pipeline',this)">Pipeline</button><button onclick="setTab('spend',this)">Spend</button><button onclick="setTab('site',this)">Site Conversion</button></div>
    <div class="toggle-group" id="periodToggle"><button onclick="setView('weekly')">Weekly</button><button class="active" onclick="setView('monthly')">Monthly</button></div>
  </div>
  <div class="period-nav"><button onclick="navigatePeriod(-1)">‚Üê</button><div class="period-label" id="periodLabel">‚Äî</div><button onclick="navigatePeriod(1)">‚Üí</button></div>
  <div class="filter-group"><select id="sourceFilter" onchange="refresh()"><option value="all">All Sources</option></select><div class="toggle-group" id="scopeToggle"><button onclick="setScope('marketing',this)">Marketing</button><button class="active" onclick="setScope('total',this)">Total</button></div></div>
</div>
<div class="main">
  <div class="tab-content active" id="tabSummary">
    <div style="margin-bottom:20px"><div class="toggle-group" id="summarySubToggle"><button class="active" onclick="setSummaryView('metrics',this)">Metrics</button><button onclick="setSummaryView('charts',this)">Charts</button></div></div>
    <div id="summaryMetricsView">
      <div class="table-card"><div class="chart-title" id="megaTitle">Summary</div><div class="mega-wrap"><table id="megaTable" style="width:100%;border-collapse:collapse"><thead id="megaHead"></thead><tbody id="megaBody"></tbody></table></div></div>
    </div>
    <div id="summaryChartsView" style="display:none">
      <div class="charts-grid">
        <div class="chart-card"><div class="chart-title">Site Traffic</div><div class="chart-container"><canvas id="megaChSiteTraffic"></canvas></div></div>
        <div class="chart-card"><div class="chart-title">Site Conversion</div><div class="chart-container"><canvas id="megaChSiteConv"></canvas></div></div>
      </div>
      <div class="charts-grid">
        <div class="chart-card"><div class="chart-title">Marketing & Sales</div><div class="chart-container"><canvas id="megaChPipeline"></canvas></div></div>
        <div class="chart-card"><div class="chart-title">Conversion Metrics</div><div class="chart-container"><canvas id="megaChConversion"></canvas></div></div>
      </div>
      <div class="charts-grid">
        <div class="chart-card"><div class="chart-title">Cost Metrics</div><div class="chart-container"><canvas id="megaChCost"></canvas></div></div>
      </div>
    </div>
  </div>
  <div class="tab-content" id="tabPipeline">
    <div class="table-card" id="summaryCard"><div class="chart-title" id="summaryTitle">Pipeline Summary</div><div style="font-size:12px;color:var(--text-dim);margin-bottom:16px">Volume metrics with conversion rates for each period</div><table><thead id="summaryHead"></thead><tbody id="summaryBody"></tbody></table></div>
    <div class="charts-grid">
      <div class="chart-card"><div class="chart-title">MQLs</div><div class="chart-container"><canvas id="chartMqls"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">SQLs</div><div class="chart-container"><canvas id="chartSqls"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">Meetings</div><div class="chart-container"><canvas id="chartMtgs"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">Sits</div><div class="chart-container"><canvas id="chartSits"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">Closes (Created)</div><div class="chart-container"><canvas id="chartClosesCreated"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">Closes (Won)</div><div class="chart-container"><canvas id="chartClosesDeal"></canvas></div></div>
    </div>
    <div class="charts-grid">
      <div class="chart-card"><div class="chart-title" id="srcMqlsTitle">MQLs by Source</div><div class="chart-container"><canvas id="srcMqls"></canvas></div></div>
      <div class="chart-card"><div class="chart-title" id="srcSqlsTitle">SQLs by Source</div><div class="chart-container"><canvas id="srcSqls"></canvas></div></div>
      <div class="chart-card"><div class="chart-title" id="srcSitsTitle">Sits by Source</div><div class="chart-container"><canvas id="srcSits"></canvas></div></div>
      <div class="chart-card"><div class="chart-title" id="srcClosesTitle">Closes by Source</div><div class="chart-container"><canvas id="srcCloses"></canvas></div></div>
    </div>
  </div>
  <div class="tab-content" id="tabSpend">
    <div class="spend-kpi-grid" id="spendKpiGrid"></div>
    <div class="charts-grid">
      <div class="chart-card"><div class="chart-title">Total Spend</div><div class="chart-container"><canvas id="chartSpend"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">Spend by Channel</div><div class="chart-container"><canvas id="chartSpendCh"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">Cost per MQL</div><div class="chart-container"><canvas id="chartCPL"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">Cost per SQL</div><div class="chart-container"><canvas id="chartCPSQL"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">Cost per Meeting</div><div class="chart-container"><canvas id="chartCPM"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">Cost per Sit</div><div class="chart-container"><canvas id="chartCPS"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">CAC (Cost per Close)</div><div class="chart-container"><canvas id="chartCAC"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">Channel Spend Trend</div><div class="chart-container"><canvas id="chartChTrend"></canvas></div></div>
    </div>
    <div class="table-card"><div class="chart-title" id="spendTableTitle">Spend & Unit Economics by Week</div><table><thead id="spendTableHead"></thead><tbody id="spendTableBody"></tbody></table></div>
  </div>
  <div class="tab-content" id="tabSite">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px">
      <div class="toggle-group" id="siteDeviceToggle"><button class="active" onclick="setSiteDev('all',this)">All</button><button onclick="setSiteDev('M',this)">Mobile</button><button onclick="setSiteDev('D',this)">Desktop</button></div>
      <label class="sync-btn" style="cursor:pointer"><input type="file" id="siteFileInput" accept=".csv" style="display:none" onchange="handleSiteUpload(event)">üìÅ Upload CSV</label>
    </div>
    <div class="table-card"><div class="chart-title" id="siteTableTitle">Site Conversion Summary</div><div style="font-size:12px;color:var(--text-dim);margin-bottom:16px">Funnel metrics with conversion rates per period</div><table><thead id="siteTableHead"></thead><tbody id="siteTableBody"></tbody></table></div>
    <div class="charts-grid">
      <div class="chart-card"><div class="chart-title">Site Visits</div><div class="chart-container"><canvas id="chartSiteVisits"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">Visited Quote Flow</div><div class="chart-container"><canvas id="chartSiteVQF"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">Completed Quote Flow</div><div class="chart-container"><canvas id="chartSiteCQF"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">Quote Requests Submitted</div><div class="chart-container"><canvas id="chartSiteQRS"></canvas></div></div>
    </div>
    <div class="charts-grid">
      <div class="chart-card"><div class="chart-title">Site Visit ‚Üí Start Quote Flow</div><div class="chart-container"><canvas id="chartSiteR1"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">QF ‚Üí Finish QF</div><div class="chart-container"><canvas id="chartSiteR2"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">Finish QF ‚Üí Request Info</div><div class="chart-container"><canvas id="chartSiteR3"></canvas></div></div>
      <div class="chart-card"><div class="chart-title">Mobile vs Desktop Conversion</div><div class="chart-container"><canvas id="chartSiteMD"></canvas></div></div>
    </div>
  </div>
</div>
<div class="sync-overlay" id="syncOverlay"><div class="sync-modal"><h3>Syncing HubSpot Data</h3><div class="sync-progress" id="syncProgress">Initializing...</div><div class="sync-detail" id="syncDetail">This may take a couple of minutes</div><div class="sync-bar-track"><div class="sync-bar-fill" id="syncBar" style="width:0%"></div></div></div></div>

<script>
const SB_URL='https://vnxerxefgodekwjdxfqc.supabase.co';
const SB_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZueGVyeGVmZ29kZWt3amR4ZnFjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg1MjY3MjgsImV4cCI6MjA4NDEwMjcyOH0.yV2rEL6PDBW2qjctwsk67-l77miABQ0ssiI6MA2CfEo';
const sb=window.supabase.createClient(SB_URL,SB_KEY);
const FUNC_URL=SB_URL+'/functions/v1/sync-growth-marketing';
const MARKETING_SOURCES=['Direct mail','Direct Mail','Meta','Google Paid','Next Door','Capital One','Referrals Program','LinkedIn'];
const CHANNELS=['Direct mail','Meta','Google Paid','Next Door','Capital One','Referrals Program'];
const CH_COLORS={'Direct mail':'#f59e0b','Meta':'#3b82f6','Google Paid':'#22d3a7','Next Door':'#a855f7','Capital One':'#ec4899','Referrals Program':'#ef4444'};

let contacts=[],meetings=[],viewMode='monthly',periodOffset=0,activeTab='summary',charts={},metricScope='total';

// ===== SPEND DATA =====
const SPEND_RAW=[{"start":"2024-09-09","end":"2024-09-15","source":"Meta","spend":200.0},{"start":"2024-09-16","end":"2024-09-22","source":"Direct mail","spend":13121.92},{"start":"2024-09-16","end":"2024-09-22","source":"Meta","spend":812.14},{"start":"2024-09-23","end":"2024-09-29","source":"Direct mail","spend":9276.75},{"start":"2024-09-23","end":"2024-09-29","source":"Google Paid","spend":6832.6},{"start":"2024-09-23","end":"2024-09-29","source":"Meta","spend":2594.96},{"start":"2024-09-30","end":"2024-10-06","source":"Direct mail","spend":4990.35},{"start":"2024-09-30","end":"2024-10-06","source":"Google Paid","spend":5028.25},{"start":"2024-09-30","end":"2024-10-06","source":"Meta","spend":3919.31},{"start":"2024-09-30","end":"2024-10-06","source":"Next Door","spend":996.0},{"start":"2024-10-07","end":"2024-10-13","source":"Direct mail","spend":18699.15},{"start":"2024-10-07","end":"2024-10-13","source":"Google Paid","spend":2032.89},{"start":"2024-10-07","end":"2024-10-13","source":"Meta","spend":4649.96},{"start":"2024-10-07","end":"2024-10-13","source":"Next Door","spend":1162.0},{"start":"2024-10-14","end":"2024-10-20","source":"Direct mail","spend":4979.9},{"start":"2024-10-14","end":"2024-10-20","source":"Google Paid","spend":2378.79},{"start":"2024-10-14","end":"2024-10-20","source":"Meta","spend":4649.52},{"start":"2024-10-14","end":"2024-10-20","source":"Next Door","spend":3298.0},{"start":"2024-10-21","end":"2024-10-27","source":"Direct mail","spend":4990.35},{"start":"2024-10-21","end":"2024-10-27","source":"Google Paid","spend":2314.9},{"start":"2024-10-21","end":"2024-10-27","source":"Meta","spend":3893.67},{"start":"2024-10-21","end":"2024-10-27","source":"Next Door","spend":3778.68},{"start":"2024-10-28","end":"2024-11-03","source":"Direct mail","spend":4896.3},{"start":"2024-10-28","end":"2024-11-03","source":"Google Paid","spend":2209.93},{"start":"2024-10-28","end":"2024-11-03","source":"Meta","spend":2314.15},{"start":"2024-10-28","end":"2024-11-03","source":"Next Door","spend":1522.61},{"start":"2024-11-04","end":"2024-11-10","source":"Google Paid","spend":2303.76},{"start":"2024-11-04","end":"2024-11-10","source":"Meta","spend":2687.41},{"start":"2024-11-04","end":"2024-11-10","source":"Next Door","spend":2660.8},{"start":"2024-11-11","end":"2024-11-17","source":"Google Paid","spend":2378.71},{"start":"2024-11-11","end":"2024-11-17","source":"Meta","spend":3361.62},{"start":"2024-11-11","end":"2024-11-17","source":"Next Door","spend":2008.89},{"start":"2024-11-18","end":"2024-11-24","source":"Google Paid","spend":2248.98},{"start":"2024-11-18","end":"2024-11-24","source":"Meta","spend":3378.19},{"start":"2024-11-18","end":"2024-11-24","source":"Next Door","spend":1752.42},{"start":"2024-11-25","end":"2024-12-01","source":"Google Paid","spend":2096.26},{"start":"2024-11-25","end":"2024-12-01","source":"Meta","spend":4623.97},{"start":"2024-11-25","end":"2024-12-01","source":"Next Door","spend":2160.0},{"start":"2024-12-02","end":"2024-12-08","source":"Direct mail","spend":4896.17},{"start":"2024-12-02","end":"2024-12-08","source":"Google Paid","spend":2829.92},{"start":"2024-12-02","end":"2024-12-08","source":"Meta","spend":4809.4},{"start":"2024-12-02","end":"2024-12-08","source":"Next Door","spend":2369.95},{"start":"2024-12-09","end":"2024-12-15","source":"Direct mail","spend":4922.73},{"start":"2024-12-09","end":"2024-12-15","source":"Google Paid","spend":9240.11},{"start":"2024-12-09","end":"2024-12-15","source":"Meta","spend":6744.22},{"start":"2024-12-09","end":"2024-12-15","source":"Next Door","spend":2240.0},{"start":"2024-12-16","end":"2024-12-22","source":"Direct mail","spend":4942.65},{"start":"2024-12-16","end":"2024-12-22","source":"Google Paid","spend":9510.96},{"start":"2024-12-16","end":"2024-12-22","source":"Meta","spend":6538.41},{"start":"2024-12-16","end":"2024-12-22","source":"Next Door","spend":1920.0},{"start":"2024-12-23","end":"2024-12-29","source":"Google Paid","spend":2835.48},{"start":"2024-12-23","end":"2024-12-29","source":"Meta","spend":2777.12},{"start":"2024-12-23","end":"2024-12-29","source":"Next Door","spend":1008.0},{"start":"2024-12-30","end":"2025-01-05","source":"Google Paid","spend":2479.59},{"start":"2024-12-30","end":"2025-01-05","source":"Meta","spend":2492.68},{"start":"2024-12-30","end":"2025-01-05","source":"Next Door","spend":1008.0},{"start":"2025-01-06","end":"2025-01-12","source":"Direct mail","spend":11123.66},{"start":"2025-01-06","end":"2025-01-12","source":"Google Paid","spend":3554.82},{"start":"2025-01-06","end":"2025-01-12","source":"Meta","spend":2992.66},{"start":"2025-01-06","end":"2025-01-12","source":"Next Door","spend":2240.0},{"start":"2025-01-06","end":"2025-01-12","source":"Referrals Program","spend":300.0},{"start":"2025-01-13","end":"2025-01-19","source":"Direct mail","spend":12127.13},{"start":"2025-01-13","end":"2025-01-19","source":"Google Paid","spend":4298.31},{"start":"2025-01-13","end":"2025-01-19","source":"Meta","spend":3485.09},{"start":"2025-01-13","end":"2025-01-19","source":"Next Door","spend":2240.0},{"start":"2025-01-13","end":"2025-01-19","source":"Referrals Program","spend":300.0},{"start":"2025-01-20","end":"2025-01-26","source":"Direct mail","spend":10866.36},{"start":"2025-01-20","end":"2025-01-26","source":"Google Paid","spend":5983.51},{"start":"2025-01-20","end":"2025-01-26","source":"Meta","spend":4297.45},{"start":"2025-01-20","end":"2025-01-26","source":"Next Door","spend":486.47},{"start":"2025-01-27","end":"2025-02-02","source":"Direct mail","spend":9811.43},{"start":"2025-01-27","end":"2025-02-02","source":"Google Paid","spend":9449.21},{"start":"2025-01-27","end":"2025-02-02","source":"Meta","spend":5313.89},{"start":"2025-01-27","end":"2025-02-02","source":"Next Door","spend":700.0},{"start":"2025-02-03","end":"2025-02-09","source":"Direct mail","spend":17120.41},{"start":"2025-02-03","end":"2025-02-09","source":"Google Paid","spend":8447.43},{"start":"2025-02-03","end":"2025-02-09","source":"Meta","spend":3625.0},{"start":"2025-02-03","end":"2025-02-09","source":"Next Door","spend":2450.0},{"start":"2025-02-10","end":"2025-02-16","source":"Direct mail","spend":17633.35},{"start":"2025-02-10","end":"2025-02-16","source":"Google Paid","spend":8271.15},{"start":"2025-02-10","end":"2025-02-16","source":"Meta","spend":4855.04},{"start":"2025-02-10","end":"2025-02-16","source":"Next Door","spend":923.1},{"start":"2025-02-17","end":"2025-02-23","source":"Capital One","spend":9000.0},{"start":"2025-02-17","end":"2025-02-23","source":"Direct mail","spend":8928.31},{"start":"2025-02-17","end":"2025-02-23","source":"Google Paid","spend":8289.38},{"start":"2025-02-17","end":"2025-02-23","source":"Meta","spend":4195.82},{"start":"2025-02-24","end":"2025-03-02","source":"Capital One","spend":3000.0},{"start":"2025-02-24","end":"2025-03-02","source":"Direct mail","spend":8926.65},{"start":"2025-02-24","end":"2025-03-02","source":"Google Paid","spend":7847.19},{"start":"2025-02-24","end":"2025-03-02","source":"Meta","spend":4233.14},{"start":"2025-03-03","end":"2025-03-09","source":"Capital One","spend":1000.0},{"start":"2025-03-03","end":"2025-03-09","source":"Direct mail","spend":9809.77},{"start":"2025-03-03","end":"2025-03-09","source":"Google Paid","spend":8814.3},{"start":"2025-03-03","end":"2025-03-09","source":"Meta","spend":4120.79},{"start":"2025-03-03","end":"2025-03-09","source":"Next Door","spend":1144.0},{"start":"2025-03-10","end":"2025-03-16","source":"Capital One","spend":2000.0},{"start":"2025-03-10","end":"2025-03-16","source":"Direct mail","spend":23335.18},{"start":"2025-03-10","end":"2025-03-16","source":"Google Paid","spend":8838.45},{"start":"2025-03-10","end":"2025-03-16","source":"Meta","spend":4246.26},{"start":"2025-03-10","end":"2025-03-16","source":"Next Door","spend":2002.0},{"start":"2025-03-10","end":"2025-03-16","source":"Referrals Program","spend":300.0},{"start":"2025-03-17","end":"2025-03-23","source":"Capital One","spend":3000.0},{"start":"2025-03-17","end":"2025-03-23","source":"Direct mail","spend":14255.11},{"start":"2025-03-17","end":"2025-03-23","source":"Google Paid","spend":6111.89},{"start":"2025-03-17","end":"2025-03-23","source":"Meta","spend":4088.02},{"start":"2025-03-17","end":"2025-03-23","source":"Next Door","spend":2002.0},{"start":"2025-03-24","end":"2025-03-30","source":"Direct mail","spend":9506.23},{"start":"2025-03-24","end":"2025-03-30","source":"Google Paid","spend":3945.02},{"start":"2025-03-24","end":"2025-03-30","source":"Meta","spend":4356.35},{"start":"2025-03-24","end":"2025-03-30","source":"Next Door","spend":2002.0},{"start":"2025-03-31","end":"2025-04-06","source":"Direct mail","spend":7864.12},{"start":"2025-03-31","end":"2025-04-06","source":"Google Paid","spend":5659.8},{"start":"2025-03-31","end":"2025-04-06","source":"Meta","spend":5861.97},{"start":"2025-03-31","end":"2025-04-06","source":"Next Door","spend":463.04},{"start":"2025-04-07","end":"2025-04-13","source":"Direct mail","spend":13276.07},{"start":"2025-04-07","end":"2025-04-13","source":"Google Paid","spend":6938.33},{"start":"2025-04-07","end":"2025-04-13","source":"Meta","spend":6235.25},{"start":"2025-04-07","end":"2025-04-13","source":"Referrals Program","spend":150.0},{"start":"2025-04-14","end":"2025-04-20","source":"Capital One","spend":1000.0},{"start":"2025-04-14","end":"2025-04-20","source":"Direct mail","spend":7030.8},{"start":"2025-04-14","end":"2025-04-20","source":"Google Paid","spend":6601.7},{"start":"2025-04-14","end":"2025-04-20","source":"Meta","spend":5604.58},{"start":"2025-04-21","end":"2025-04-27","source":"Direct mail","spend":12143.3},{"start":"2025-04-21","end":"2025-04-27","source":"Google Paid","spend":6320.8},{"start":"2025-04-21","end":"2025-04-27","source":"Meta","spend":5555.4},{"start":"2025-04-21","end":"2025-04-27","source":"Referrals Program","spend":150.0},{"start":"2025-04-28","end":"2025-05-04","source":"Capital One","spend":2000.0},{"start":"2025-04-28","end":"2025-05-04","source":"Direct mail","spend":11124.61},{"start":"2025-04-28","end":"2025-05-04","source":"Google Paid","spend":5549.72},{"start":"2025-04-28","end":"2025-05-04","source":"Meta","spend":5298.72},{"start":"2025-04-28","end":"2025-05-04","source":"Referrals Program","spend":600.0},{"start":"2025-05-05","end":"2025-05-11","source":"Capital One","spend":8000.0},{"start":"2025-05-05","end":"2025-05-11","source":"Direct mail","spend":10778.57},{"start":"2025-05-05","end":"2025-05-11","source":"Google Paid","spend":5648.18},{"start":"2025-05-05","end":"2025-05-11","source":"Meta","spend":3706.19},{"start":"2025-05-05","end":"2025-05-11","source":"Referrals Program","spend":600.0},{"start":"2025-05-12","end":"2025-05-18","source":"Capital One","spend":1000.0},{"start":"2025-05-12","end":"2025-05-18","source":"Direct mail","spend":6813.29},{"start":"2025-05-12","end":"2025-05-18","source":"Google Paid","spend":6493.2},{"start":"2025-05-12","end":"2025-05-18","source":"Meta","spend":4277.61},{"start":"2025-05-12","end":"2025-05-18","source":"Referrals Program","spend":450.0},{"start":"2025-05-19","end":"2025-05-25","source":"Capital One","spend":4000.0},{"start":"2025-05-19","end":"2025-05-25","source":"Direct mail","spend":11623.58},{"start":"2025-05-19","end":"2025-05-25","source":"Google Paid","spend":4710.67},{"start":"2025-05-19","end":"2025-05-25","source":"Meta","spend":6571.62},{"start":"2025-05-19","end":"2025-05-25","source":"Referrals Program","spend":600.0},{"start":"2025-05-26","end":"2025-06-01","source":"Capital One","spend":2000.0},{"start":"2025-05-26","end":"2025-06-01","source":"Direct mail","spend":9705.61},{"start":"2025-05-26","end":"2025-06-01","source":"Google Paid","spend":8075.03},{"start":"2025-05-26","end":"2025-06-01","source":"Meta","spend":7356.31},{"start":"2025-05-26","end":"2025-06-01","source":"Referrals Program","spend":300.0},{"start":"2025-06-02","end":"2025-06-08","source":"Capital One","spend":2000.0},{"start":"2025-06-02","end":"2025-06-08","source":"Direct mail","spend":8939.31},{"start":"2025-06-02","end":"2025-06-08","source":"Google Paid","spend":7488.31},{"start":"2025-06-02","end":"2025-06-08","source":"Meta","spend":7248.23},{"start":"2025-06-02","end":"2025-06-08","source":"Referrals Program","spend":150.0},{"start":"2025-06-09","end":"2025-06-15","source":"Direct mail","spend":22502.41},{"start":"2025-06-09","end":"2025-06-15","source":"Google Paid","spend":5904.49},{"start":"2025-06-09","end":"2025-06-15","source":"Meta","spend":7331.47},{"start":"2025-06-09","end":"2025-06-15","source":"Referrals Program","spend":600.0},{"start":"2025-06-16","end":"2025-06-22","source":"Direct mail","spend":26263.45},{"start":"2025-06-16","end":"2025-06-22","source":"Google Paid","spend":5377.15},{"start":"2025-06-16","end":"2025-06-22","source":"Meta","spend":5361.61},{"start":"2025-06-16","end":"2025-06-22","source":"Referrals Program","spend":300.0},{"start":"2025-06-23","end":"2025-06-29","source":"Direct mail","spend":22297.06},{"start":"2025-06-23","end":"2025-06-29","source":"Google Paid","spend":6242.76},{"start":"2025-06-23","end":"2025-06-29","source":"Meta","spend":2995.15},{"start":"2025-06-23","end":"2025-06-29","source":"Referrals Program","spend":750.0},{"start":"2025-06-30","end":"2025-07-06","source":"Direct mail","spend":11485.2},{"start":"2025-06-30","end":"2025-07-06","source":"Google Paid","spend":5159.98},{"start":"2025-06-30","end":"2025-07-06","source":"Meta","spend":2681.21},{"start":"2025-06-30","end":"2025-07-06","source":"Referrals Program","spend":1500.0},{"start":"2025-07-07","end":"2025-07-13","source":"Capital One","spend":3000.0},{"start":"2025-07-07","end":"2025-07-13","source":"Direct mail","spend":11417.67},{"start":"2025-07-07","end":"2025-07-13","source":"Google Paid","spend":3959.28},{"start":"2025-07-07","end":"2025-07-13","source":"Meta","spend":2793.36},{"start":"2025-07-14","end":"2025-07-20","source":"Direct mail","spend":11335.2},{"start":"2025-07-14","end":"2025-07-20","source":"Google Paid","spend":8804.91},{"start":"2025-07-14","end":"2025-07-20","source":"Meta","spend":2895.09},{"start":"2025-07-14","end":"2025-07-20","source":"Referrals Program","spend":1650.0},{"start":"2025-07-21","end":"2025-07-27","source":"Capital One","spend":13000.0},{"start":"2025-07-21","end":"2025-07-27","source":"Direct mail","spend":11579.97},{"start":"2025-07-21","end":"2025-07-27","source":"Google Paid","spend":6525.26},{"start":"2025-07-21","end":"2025-07-27","source":"Meta","spend":2900.83},{"start":"2025-07-21","end":"2025-07-27","source":"Referrals Program","spend":500.0},{"start":"2025-07-28","end":"2025-08-03","source":"Capital One","spend":2000.0},{"start":"2025-07-28","end":"2025-08-03","source":"Direct mail","spend":11968.02},{"start":"2025-07-28","end":"2025-08-03","source":"Google Paid","spend":5746.83},{"start":"2025-07-28","end":"2025-08-03","source":"Meta","spend":2911.2},{"start":"2025-07-28","end":"2025-08-03","source":"Referrals Program","spend":500.0},{"start":"2025-08-04","end":"2025-08-10","source":"Direct mail","spend":13614.54},{"start":"2025-08-04","end":"2025-08-10","source":"Google Paid","spend":7924.3},{"start":"2025-08-04","end":"2025-08-10","source":"Meta","spend":2929.78},{"start":"2025-08-04","end":"2025-08-10","source":"Referrals Program","spend":2000.0},{"start":"2025-08-11","end":"2025-08-17","source":"Direct mail","spend":26629.05},{"start":"2025-08-11","end":"2025-08-17","source":"Google Paid","spend":8200.81},{"start":"2025-08-11","end":"2025-08-17","source":"Meta","spend":2901.51},{"start":"2025-08-11","end":"2025-08-17","source":"Referrals Program","spend":1500.0},{"start":"2025-08-18","end":"2025-08-24","source":"Capital One","spend":2000.0},{"start":"2025-08-18","end":"2025-08-24","source":"Direct mail","spend":28280.76},{"start":"2025-08-18","end":"2025-08-24","source":"Google Paid","spend":8499.51},{"start":"2025-08-18","end":"2025-08-24","source":"Meta","spend":2921.28},{"start":"2025-08-18","end":"2025-08-24","source":"Referrals Program","spend":2000.0},{"start":"2025-08-25","end":"2025-08-31","source":"Capital One","spend":1000.0},{"start":"2025-08-25","end":"2025-08-31","source":"Direct mail","spend":24685.17},{"start":"2025-08-25","end":"2025-08-31","source":"Google Paid","spend":5984.93},{"start":"2025-08-25","end":"2025-08-31","source":"Meta","spend":3305.03},{"start":"2025-08-25","end":"2025-08-31","source":"Referrals Program","spend":450.0},{"start":"2025-09-01","end":"2025-09-07","source":"Capital One","spend":4000.0},{"start":"2025-09-01","end":"2025-09-07","source":"Direct mail","spend":12401.49},{"start":"2025-09-01","end":"2025-09-07","source":"Google Paid","spend":6518.35},{"start":"2025-09-01","end":"2025-09-07","source":"Meta","spend":3755.95},{"start":"2025-09-01","end":"2025-09-07","source":"Referrals Program","spend":450.0},{"start":"2025-09-08","end":"2025-09-14","source":"Capital One","spend":1000.0},{"start":"2025-09-08","end":"2025-09-14","source":"Direct mail","spend":11136.06},{"start":"2025-09-08","end":"2025-09-14","source":"Google Paid","spend":7860.81},{"start":"2025-09-08","end":"2025-09-14","source":"Meta","spend":4894.95},{"start":"2025-09-08","end":"2025-09-14","source":"Referrals Program","spend":300.0},{"start":"2025-09-15","end":"2025-09-21","source":"Direct mail","spend":16477.34},{"start":"2025-09-15","end":"2025-09-21","source":"Google Paid","spend":9927.77},{"start":"2025-09-15","end":"2025-09-21","source":"Meta","spend":4693.73},{"start":"2025-09-15","end":"2025-09-21","source":"Referrals Program","spend":450.0},{"start":"2025-09-22","end":"2025-09-28","source":"Capital One","spend":4000.0},{"start":"2025-09-22","end":"2025-09-28","source":"Direct mail","spend":22747.16},{"start":"2025-09-22","end":"2025-09-28","source":"Google Paid","spend":11601.67},{"start":"2025-09-22","end":"2025-09-28","source":"Meta","spend":4850.46},{"start":"2025-09-22","end":"2025-09-28","source":"Referrals Program","spend":300.0},{"start":"2025-09-29","end":"2025-10-05","source":"Direct mail","spend":25363.86},{"start":"2025-09-29","end":"2025-10-05","source":"Google Paid","spend":10862.58},{"start":"2025-09-29","end":"2025-10-05","source":"Meta","spend":5180.85},{"start":"2025-09-29","end":"2025-10-05","source":"Referrals Program","spend":500.0},{"start":"2025-10-06","end":"2025-10-12","source":"Direct mail","spend":22576.92},{"start":"2025-10-06","end":"2025-10-12","source":"Google Paid","spend":9638.95},{"start":"2025-10-06","end":"2025-10-12","source":"Meta","spend":5927.31},{"start":"2025-10-13","end":"2025-10-19","source":"Capital One","spend":1000.0},{"start":"2025-10-13","end":"2025-10-19","source":"Direct mail","spend":27295.95},{"start":"2025-10-13","end":"2025-10-19","source":"Google Paid","spend":13834.67},{"start":"2025-10-13","end":"2025-10-19","source":"Meta","spend":6717.06},{"start":"2025-10-13","end":"2025-10-19","source":"Referrals Program","spend":1500.0},{"start":"2025-10-20","end":"2025-10-26","source":"Direct mail","spend":76466.48},{"start":"2025-10-20","end":"2025-10-26","source":"Google Paid","spend":8263.61},{"start":"2025-10-20","end":"2025-10-26","source":"Meta","spend":6787.33},{"start":"2025-10-27","end":"2025-11-02","source":"Capital One","spend":1000.0},{"start":"2025-10-27","end":"2025-11-02","source":"Direct mail","spend":74607.96},{"start":"2025-10-27","end":"2025-11-02","source":"Google Paid","spend":7933.31},{"start":"2025-10-27","end":"2025-11-02","source":"Meta","spend":6799.09},{"start":"2025-10-27","end":"2025-11-02","source":"Referrals Program","spend":2000.0},{"start":"2025-11-03","end":"2025-11-09","source":"Capital One","spend":1000.0},{"start":"2025-11-03","end":"2025-11-09","source":"Direct mail","spend":59746.05},{"start":"2025-11-03","end":"2025-11-09","source":"Google Paid","spend":10593.96},{"start":"2025-11-03","end":"2025-11-09","source":"Meta","spend":6020.61},{"start":"2025-11-10","end":"2025-11-16","source":"Capital One","spend":2000.0},{"start":"2025-11-10","end":"2025-11-16","source":"Direct mail","spend":56027.7},{"start":"2025-11-10","end":"2025-11-16","source":"Google Paid","spend":4674.01},{"start":"2025-11-10","end":"2025-11-16","source":"Meta","spend":7446.18},{"start":"2025-11-10","end":"2025-11-16","source":"Referrals Program","spend":1000.0},{"start":"2025-11-17","end":"2025-11-23","source":"Direct mail","spend":40120.98},{"start":"2025-11-17","end":"2025-11-23","source":"Google Paid","spend":3924.25},{"start":"2025-11-17","end":"2025-11-23","source":"Meta","spend":6857.9},{"start":"2025-11-24","end":"2025-11-30","source":"Direct mail","spend":80368.17},{"start":"2025-11-24","end":"2025-11-30","source":"Google Paid","spend":3170.04},{"start":"2025-11-24","end":"2025-11-30","source":"Meta","spend":2678.54},{"start":"2025-12-01","end":"2025-12-07","source":"Capital One","spend":2000.0},{"start":"2025-12-01","end":"2025-12-07","source":"Direct mail","spend":57864.3},{"start":"2025-12-01","end":"2025-12-07","source":"Google Paid","spend":3855.4},{"start":"2025-12-01","end":"2025-12-07","source":"Meta","spend":2733.43},{"start":"2025-12-08","end":"2025-12-14","source":"Capital One","spend":2000.0},{"start":"2025-12-08","end":"2025-12-14","source":"Direct mail","spend":82925.94},{"start":"2025-12-08","end":"2025-12-14","source":"Google Paid","spend":6649.48},{"start":"2025-12-08","end":"2025-12-14","source":"Meta","spend":3527.64},{"start":"2025-12-15","end":"2025-12-21","source":"Capital One","spend":2000.0},{"start":"2025-12-15","end":"2025-12-21","source":"Direct mail","spend":98663.35},{"start":"2025-12-15","end":"2025-12-21","source":"Google Paid","spend":3016.2},{"start":"2025-12-15","end":"2025-12-21","source":"Meta","spend":1924.88},{"start":"2025-12-22","end":"2025-12-28","source":"Capital One","spend":1000.0},{"start":"2025-12-22","end":"2025-12-28","source":"Direct mail","spend":2775.0},{"start":"2025-12-29","end":"2025-12-31","source":"Direct mail","spend":600.0},{"start":"2026-01-19","end":"2026-01-25","source":"Direct mail","spend":10795.08},{"start":"2026-01-19","end":"2026-01-25","source":"Google Paid","spend":614.41},{"start":"2026-01-19","end":"2026-01-25","source":"Meta","spend":748.13},{"start":"2026-01-26","end":"2026-02-01","source":"Direct mail","spend":10991.04},{"start":"2026-01-26","end":"2026-02-01","source":"Google Paid","spend":1454.73},{"start":"2026-01-26","end":"2026-02-01","source":"Meta","spend":794.42},{"start":"2026-02-02","end":"2026-02-08","source":"Direct mail","spend":10582.68},{"start":"2026-02-02","end":"2026-02-08","source":"Google Paid","spend":1481.16},{"start":"2026-02-02","end":"2026-02-08","source":"Meta","spend":3795.79},{"start":"2026-02-09","end":"2026-02-15","source":"Direct mail","spend":36760.11},{"start":"2026-02-09","end":"2026-02-15","source":"Google Paid","spend":1584.18},{"start":"2026-02-09","end":"2026-02-15","source":"Meta","spend":5473.09},{"start":"2026-02-16","end":"2026-02-22","source":"Direct mail","spend":11717.24},{"start":"2026-02-16","end":"2026-02-22","source":"Meta","spend":3609.36},{"start":"2026-02-16","end":"2026-02-22","source":"Google Paid","spend":1998.32}];

const SITE_RAW=[["2024-01-01",59,2,2,3,19,0,1,1,40,2,1,2],["2024-01-02",91,4,16,0,30,1,14,0,61,3,2,0],["2024-01-03",83,2,13,0,32,0,7,0,51,2,6,0],["2024-01-04",95,1,2,0,18,0,1,0,77,1,1,0],["2024-01-05",59,4,7,0,19,1,4,0,40,3,3,0],["2024-01-06",45,1,10,2,25,0,7,2,20,1,3,0],["2024-01-07",57,1,3,0,22,0,3,0,35,1,0,0],["2024-01-08",71,1,9,2,17,1,4,2,54,0,5,0],["2024-01-09",93,4,9,2,23,1,6,1,70,3,3,1],["2024-01-10",112,5,32,5,53,3,26,4,59,2,6,1],["2024-01-11",116,6,22,3,35,3,15,2,81,3,7,1],["2024-01-12",104,4,19,0,38,0,11,0,66,4,8,0],["2024-01-13",58,2,10,2,34,1,7,1,24,1,3,1],["2024-01-14",59,2,11,2,24,1,6,2,35,1,5,0],["2024-01-15",88,3,7,0,30,2,5,0,58,1,2,0],["2024-01-16",103,8,4,0,17,3,1,0,86,5,3,0],["2024-01-17",95,3,5,0,22,1,2,0,73,2,3,0],["2024-01-18",95,1,3,0,29,1,2,0,66,0,1,0],["2024-01-19",55,2,2,0,12,0,1,0,43,2,1,0],["2024-01-20",76,2,8,0,30,0,5,0,46,2,3,0],["2024-01-21",56,2,2,0,25,0,2,0,31,2,0,0],["2024-01-22",87,2,6,0,17,1,2,0,70,1,4,0],["2024-01-23",85,5,13,1,25,2,9,1,60,3,4,0],["2024-01-24",100,5,12,1,28,1,7,0,72,4,5,1],["2024-01-25",113,6,20,0,38,3,16,0,75,3,4,0],["2024-01-26",87,10,17,1,32,4,10,1,55,6,7,0],["2024-01-27",46,2,7,0,24,1,5,0,22,1,2,0],["2024-01-28",49,1,6,2,21,1,4,1,28,0,2,1],["2024-01-29",118,7,10,1,37,2,6,0,81,5,4,1],["2024-01-30",667,25,46,4,210,15,33,2,457,10,13,2],["2024-01-31",621,20,26,2,160,10,12,2,461,10,14,0],["2024-02-01",294,8,8,0,97,3,5,0,197,5,3,0],["2024-02-02",266,7,17,2,76,2,6,0,190,5,11,2],["2024-02-03",123,4,25,2,73,4,21,2,50,0,4,0],["2024-02-04",161,5,18,0,54,0,9,0,107,5,9,0],["2024-02-05",334,7,25,4,80,5,16,2,254,2,9,2],["2024-02-06",359,11,67,5,113,1,47,4,246,10,20,1],["2024-02-07",211,5,36,6,74,1,23,5,137,4,13,1],["2024-02-08",193,4,15,3,67,2,10,2,126,2,5,1],["2024-02-09",162,7,22,3,41,3,13,2,121,4,9,1],["2024-02-10",83,6,14,2,47,2,9,1,36,4,5,1],["2024-02-11",83,2,11,2,52,1,6,0,31,1,5,2],["2024-02-12",147,4,5,0,33,0,3,0,114,4,2,0],["2024-02-13",158,3,37,5,60,1,28,5,98,2,9,0],["2024-02-14",125,5,18,2,43,1,16,2,82,4,2,0],["2024-02-15",942,20,7,1,35,0,4,0,907,20,3,1],["2024-02-16",122,6,13,2,41,2,7,2,81,4,6,0],["2024-02-17",74,3,10,1,41,0,8,0,33,3,2,1],["2024-02-18",65,3,10,0,20,1,6,0,45,2,4,0],["2024-02-19",114,4,11,3,32,2,5,1,82,2,6,2],["2024-02-20",183,10,37,3,51,2,21,3,132,8,16,0],["2024-02-21",187,8,32,5,63,2,22,4,124,6,10,1],["2024-02-22",161,9,21,3,45,3,11,3,116,6,10,0],["2024-02-23",152,3,19,2,49,2,12,2,103,1,7,0],["2024-02-24",80,2,11,1,42,1,8,0,38,1,3,1],["2024-02-25",73,3,2,0,30,0,1,0,43,3,1,0],["2024-02-26",124,1,8,2,32,0,4,1,92,1,4,1],["2024-02-27",120,7,10,1,42,1,5,0,78,6,5,1],["2024-02-28",142,0,26,3,57,0,22,3,85,0,4,0],["2024-02-29",105,6,14,1,38,1,7,1,67,5,7,0],["2024-03-01",113,3,10,0,39,0,8,0,74,3,2,0],["2024-03-02",91,2,10,4,31,1,6,2,60,1,4,2],["2024-03-03",75,1,10,1,34,1,6,1,41,0,4,0],["2024-03-04",133,3,12,1,31,1,7,1,102,2,5,0],["2024-03-05",130,4,4,0,29,0,2,0,101,4,2,0],["2024-03-06",126,2,7,1,25,0,3,0,101,2,4,1],["2024-03-07",149,6,37,3,56,1,29,2,93,5,8,1],["2024-03-08",99,3,22,3,47,0,17,3,52,3,5,0],["2024-03-09",58,3,10,1,32,1,8,1,26,2,2,0],["2024-03-10",56,2,13,1,28,1,10,1,28,1,3,0],["2024-03-11",104,7,18,3,27,0,12,2,77,7,6,1],["2024-03-12",111,2,11,1,29,0,7,1,82,2,4,0],["2024-03-13",115,5,15,1,29,0,7,0,86,5,8,1],["2024-03-14",102,2,7,1,25,0,3,0,77,2,4,1],["2024-03-15",92,2,8,0,27,1,6,0,65,1,2,0],["2024-03-16",52,4,4,1,22,1,3,1,30,3,1,0],["2024-03-17",46,1,6,0,29,1,6,0,17,0,0,0],["2024-03-18",101,3,6,0,26,0,2,0,75,3,4,0],["2024-03-19",127,2,19,0,46,0,18,0,81,2,1,0],["2024-03-20",155,7,19,0,43,3,11,0,112,4,8,0],["2024-03-21",160,10,27,2,57,2,22,2,103,8,5,0],["2024-03-22",89,4,18,2,33,1,14,2,56,3,4,0],["2024-03-23",78,4,12,0,40,1,11,0,38,3,1,0],["2024-03-24",80,4,12,1,36,1,9,1,44,3,3,0],["2024-03-25",153,8,50,2,75,3,43,1,78,5,7,1],["2024-03-26",141,6,29,1,61,3,25,1,80,3,4,0],["2024-03-27",132,6,24,2,52,1,20,1,80,5,4,1],["2024-03-28",222,24,19,2,32,0,11,2,190,24,8,0],["2024-03-29",94,1,11,0,26,0,7,0,68,1,4,0],["2024-03-30",60,3,14,0,33,1,12,0,27,2,2,0],["2024-03-31",71,3,10,0,33,1,8,0,38,2,2,0],["2024-04-01",110,1,18,0,36,1,11,0,74,0,7,0],["2024-04-02",129,10,24,0,51,1,18,0,78,9,6,0],["2024-04-03",108,5,8,0,31,0,5,0,77,5,3,0],["2024-04-04",127,6,16,0,40,1,11,0,87,5,5,0],["2024-04-05",109,6,17,1,40,0,14,1,69,6,3,0],["2024-04-06",82,2,15,3,36,0,14,2,46,2,1,1],["2024-04-07",62,3,14,3,23,2,9,1,39,1,5,2],["2024-04-08",118,2,12,2,32,1,9,1,86,1,3,1],["2024-04-09",110,2,13,0,25,0,8,0,85,2,5,0],["2024-04-10",101,4,6,1,25,1,4,0,76,3,2,1],["2024-04-11",98,2,9,2,29,0,7,2,69,2,2,0],["2024-04-12",73,4,8,1,18,0,4,1,55,4,4,0],["2024-04-13",64,6,12,3,33,3,7,1,31,3,5,2],["2024-04-14",59,1,12,1,29,1,11,1,30,0,1,0],["2024-04-15",106,2,11,2,23,0,7,2,83,2,4,0],["2024-04-16",109,8,24,5,40,3,20,4,69,5,4,1],["2024-04-17",115,3,14,1,39,2,13,1,76,1,1,0],["2024-04-18",144,4,15,1,36,1,12,1,108,3,3,0],["2024-04-19",97,2,11,0,32,1,8,0,65,1,3,0],["2024-04-20",51,1,6,0,22,0,4,0,29,1,2,0],["2024-04-21",57,1,4,0,24,1,3,0,33,0,1,0],["2024-04-22",146,4,25,2,48,0,20,2,98,4,5,0],["2024-04-23",111,2,21,2,38,2,14,1,73,0,7,1],["2024-04-24",83,1,10,0,31,0,8,0,52,1,2,0],["2024-04-25",125,5,31,0,49,1,25,0,76,4,6,0],["2024-04-26",85,3,15,1,33,1,11,1,52,2,4,0],["2024-04-27",66,1,15,1,34,1,11,1,32,0,4,0],["2024-04-28",47,1,13,1,22,1,12,1,25,0,1,0],["2024-04-29",113,2,11,0,37,1,8,0,76,1,3,0],["2024-04-30",155,2,8,0,39,2,5,0,116,0,3,0],["2024-05-01",113,6,6,1,27,2,3,0,86,4,3,1],["2024-05-02",80,1,6,1,20,1,6,1,60,0,0,0],["2024-05-03",84,1,5,1,23,1,2,0,61,0,3,1],["2024-05-04",36,1,2,0,10,0,0,0,26,1,2,0],["2024-05-05",36,1,8,0,15,0,7,0,21,1,1,0],["2024-05-06",101,5,6,0,24,1,3,0,77,4,3,0],["2024-05-07",89,3,5,0,14,1,2,0,75,2,3,0],["2024-05-08",105,6,7,0,21,0,3,0,84,6,4,0],["2024-05-09",65,4,5,0,8,0,2,0,57,4,3,0],["2024-05-10",72,3,3,0,19,0,2,0,53,3,1,0],["2024-05-11",33,0,0,0,7,0,0,0,26,0,0,0],["2024-05-12",44,1,7,2,22,1,7,2,22,0,0,0],["2024-05-13",94,8,4,1,22,2,2,1,72,6,2,0],["2024-05-14",75,6,5,1,7,0,0,0,68,6,5,1],["2024-05-15",96,4,7,1,20,0,3,1,76,4,4,0],["2024-05-16",92,4,6,0,25,0,2,0,67,4,4,0],["2024-05-17",88,6,9,0,21,3,6,0,67,3,3,0],["2024-05-18",41,8,5,1,16,2,2,0,25,6,3,1],["2024-05-19",39,2,5,0,15,2,3,0,24,0,2,0],["2024-05-20",69,4,3,1,13,1,1,1,56,3,2,0],["2024-05-21",114,5,7,1,18,2,3,0,96,3,4,1],["2024-05-22",110,3,5,0,27,1,3,0,83,2,2,0],["2024-05-23",76,5,1,0,12,1,0,0,64,4,1,0],["2024-05-24",63,3,3,0,14,0,0,0,49,3,3,0],["2024-05-25",35,3,3,0,8,1,2,0,27,2,1,0],["2024-05-26",38,2,4,0,14,1,3,0,24,1,1,0],["2024-05-27",45,3,3,1,12,1,1,0,33,2,2,1],["2024-05-28",98,5,9,0,21,1,2,0,77,4,7,0],["2024-05-29",69,2,6,1,16,0,3,1,53,2,3,0],["2024-05-30",196,6,5,1,24,2,3,0,172,4,2,1],["2024-05-31",84,5,1,0,18,0,0,0,66,5,1,0],["2024-06-01",41,2,0,0,12,1,0,0,29,1,0,0],["2024-06-02",31,2,4,0,13,0,3,0,18,2,1,0],["2024-06-03",104,8,5,1,21,1,2,1,83,7,3,0],["2024-06-04",70,5,2,0,19,1,0,0,51,4,2,0],["2024-06-05",76,5,4,0,14,1,1,0,62,4,3,0],["2024-06-06",85,0,2,0,26,0,1,0,59,0,1,0],["2024-06-07",48,6,4,1,11,1,0,0,37,5,4,1],["2024-06-08",25,1,0,0,14,0,0,0,11,1,0,0],["2024-06-09",44,3,3,0,17,3,3,0,27,0,0,0],["2024-06-10",102,8,3,0,24,4,3,0,78,4,0,0],["2024-06-11",125,4,2,0,41,2,2,0,84,2,0,0],["2024-06-12",93,5,2,0,24,3,1,0,69,2,1,0],["2024-06-13",93,9,8,1,36,6,6,0,57,3,2,1],["2024-06-14",90,17,14,3,32,13,11,3,58,4,3,0],["2024-06-15",38,13,8,2,20,9,7,1,18,4,1,1],["2024-06-16",47,3,2,1,20,3,2,1,27,0,0,0],["2024-06-17",85,14,7,1,22,4,6,1,63,10,1,0],["2024-06-18",86,13,4,0,17,5,1,0,69,8,3,0],["2024-06-19",65,6,3,1,18,4,2,1,47,2,1,0],["2024-06-20",76,8,4,1,15,3,1,0,61,5,3,1],["2024-06-21",66,6,3,1,16,5,3,1,50,1,0,0],["2024-06-22",32,3,4,0,13,2,3,0,19,1,1,0],["2024-06-23",27,2,1,1,3,1,0,0,24,1,1,1],["2024-06-24",77,18,8,2,27,12,7,1,50,6,1,1],["2024-06-25",103,23,18,2,33,14,14,2,70,9,4,0],["2024-06-26",119,28,19,4,41,20,13,4,78,8,6,0],["2024-06-27",106,22,14,3,44,16,9,0,62,6,5,3],["2024-06-28",66,14,6,2,30,12,5,2,36,2,1,0],["2024-06-29",28,3,2,0,9,3,2,0,19,0,0,0],["2024-06-30",50,9,5,1,19,7,5,1,31,2,0,0],["2024-07-01",96,15,9,0,25,6,4,0,71,9,5,0],["2024-07-02",105,12,8,1,35,7,5,0,70,5,3,1],["2024-07-03",68,9,7,2,17,5,3,1,51,4,4,1],["2024-07-04",59,10,2,0,21,7,0,0,38,3,2,0],["2024-07-05",51,6,2,0,6,1,0,0,45,5,2,0],["2024-07-06",34,3,3,1,14,1,2,0,20,2,1,1],["2024-07-07",37,3,0,0,14,1,0,0,23,2,0,0],["2024-07-08",99,5,3,0,19,1,1,0,80,4,2,0],["2024-07-09",96,6,3,0,20,3,3,0,76,3,0,0],["2024-07-10",108,20,13,1,29,9,8,0,79,11,5,1],["2024-07-11",87,11,8,2,28,5,4,1,59,6,4,1],["2024-07-12",82,12,2,1,28,7,1,0,54,5,1,1],["2024-07-13",64,7,1,0,24,5,1,0,40,2,0,0],["2024-07-14",57,2,1,0,17,0,0,0,40,2,1,0],["2024-07-15",94,11,5,0,31,4,2,0,63,7,3,0],["2024-07-16",126,13,9,0,39,8,6,0,87,5,3,0],["2024-07-17",91,9,4,1,26,2,1,0,65,7,3,1],["2024-07-18",55,4,1,0,15,2,1,0,40,2,0,0],["2024-07-19",44,1,0,0,9,1,0,0,35,0,0,0],["2024-07-20",24,3,1,0,13,3,1,0,11,0,0,0],["2024-07-21",41,5,1,0,21,5,1,0,20,0,0,0],["2024-07-22",92,11,5,0,29,6,3,0,63,5,2,0],["2024-07-23",95,12,5,1,20,3,3,0,75,9,2,1],["2024-07-24",95,7,5,1,23,2,1,0,72,5,4,1],["2024-07-25",59,7,1,0,15,6,1,0,44,1,0,0],["2024-07-26",74,6,4,1,21,3,3,1,53,3,1,0],["2024-07-27",37,2,1,1,15,1,0,0,22,1,1,1],["2024-07-28",42,3,2,1,18,1,1,0,24,2,1,1],["2024-07-29",54,3,1,0,8,1,0,0,46,2,1,0],["2024-07-30",81,6,1,1,13,1,0,0,68,5,1,1],["2024-07-31",58,4,1,0,11,1,1,0,47,3,0,0],["2024-08-01",81,7,5,0,14,1,1,0,67,6,4,0],["2024-08-02",49,3,2,0,8,1,1,0,41,2,1,0],["2024-08-03",41,4,2,1,11,0,0,0,30,4,2,1],["2024-08-04",48,2,2,0,12,1,1,0,36,1,1,0],["2024-08-05",85,4,2,0,19,0,0,0,66,4,2,0],["2024-08-06",81,4,0,0,19,1,0,0,62,3,0,0],["2024-08-07",62,6,3,0,13,3,2,0,49,3,1,0],["2024-08-08",65,3,2,0,10,1,1,0,55,2,1,0],["2024-08-09",46,4,3,1,12,0,1,0,34,4,2,1],["2024-08-10",31,2,1,0,10,1,0,0,21,1,1,0],["2024-08-11",23,2,2,1,5,0,2,1,18,2,0,0],["2024-08-12",84,11,7,0,17,6,4,0,67,5,3,0],["2024-08-13",104,9,6,2,24,3,3,1,80,6,3,1],["2024-08-14",67,9,4,2,13,3,1,0,54,6,3,2],["2024-08-15",55,6,2,1,5,1,1,0,50,5,1,1],["2024-08-16",87,11,2,0,16,3,0,0,71,8,2,0],["2024-08-17",23,3,1,0,9,1,0,0,14,2,1,0],["2024-08-18",41,5,3,1,9,2,1,1,32,3,2,0],["2024-08-19",69,5,1,1,16,2,0,0,53,3,1,1],["2024-08-20",86,10,4,0,12,2,0,0,74,8,4,0],["2024-08-21",61,4,1,1,13,2,0,0,48,2,1,1],["2024-08-22",55,6,5,1,13,2,2,0,42,4,3,1],["2024-08-23",55,3,2,1,19,3,2,1,36,0,0,0],["2024-08-24",32,5,4,1,13,1,1,1,19,4,3,0],["2024-08-25",39,4,5,2,14,1,2,0,25,3,3,2],["2024-08-26",69,5,4,0,13,3,2,0,56,2,2,0],["2024-08-27",63,7,4,0,10,3,2,0,53,4,2,0],["2024-08-28",56,5,4,0,10,0,1,0,46,5,3,0],["2024-08-29",86,11,4,0,28,8,3,0,58,3,1,0],["2024-08-30",88,8,4,1,30,3,3,1,58,5,1,0],["2024-08-31",45,11,4,1,18,7,3,1,27,4,1,0],["2024-09-01",56,5,3,1,23,3,1,0,33,2,2,1],["2024-09-02",53,10,5,0,18,6,1,0,35,4,4,0],["2024-09-03",83,6,2,1,23,3,1,1,60,3,1,0],["2024-09-04",94,5,2,0,29,1,1,0,65,4,1,0],["2024-09-05",76,3,3,1,13,1,1,0,63,2,2,1],["2024-09-06",105,14,5,0,28,5,2,0,77,9,3,0],["2024-09-07",40,11,7,0,21,6,3,0,19,5,4,0],["2024-09-08",42,5,4,1,16,4,3,1,26,1,1,0],["2024-09-09",79,11,4,0,18,3,1,0,61,8,3,0],["2024-09-10",68,4,1,0,16,1,1,0,52,3,0,0],["2024-09-11",87,11,5,3,23,4,2,2,64,7,3,1],["2024-09-12",82,9,2,0,15,3,1,0,67,6,1,0],["2024-09-13",64,12,9,0,15,3,2,0,49,9,7,0],["2024-09-14",41,3,0,0,16,2,0,0,25,1,0,0],["2024-09-15",44,5,2,0,11,2,2,0,33,3,0,0],["2024-09-16",91,7,2,1,19,0,0,0,72,7,2,1],["2024-09-17",76,13,4,1,19,5,1,1,57,8,3,0],["2024-09-18",62,11,2,0,19,4,0,0,43,7,2,0],["2024-09-19",107,13,2,0,25,3,0,0,82,10,2,0],["2024-09-20",84,6,1,0,18,2,0,0,66,4,1,0],["2024-09-21",31,3,1,0,18,2,1,0,13,1,0,0],["2024-09-22",33,5,2,0,15,3,1,0,18,2,1,0],["2024-09-23",67,7,0,0,19,3,0,0,48,4,0,0],["2024-09-24",65,2,0,0,16,0,0,0,49,2,0,0],["2024-09-25",75,7,2,1,18,3,1,0,57,4,1,1],["2024-09-26",85,10,4,1,35,6,3,1,50,4,1,0],["2024-09-27",95,11,0,0,40,6,0,0,55,5,0,0],["2024-09-28",41,5,0,0,19,4,0,0,22,1,0,0],["2024-09-29",57,6,1,0,22,2,0,0,35,4,1,0],["2024-09-30",92,10,0,0,16,2,0,0,76,8,0,0],["2024-10-01",81,10,2,0,15,2,1,0,66,8,1,0],["2024-10-02",80,8,2,0,17,2,0,0,63,6,2,0],["2024-10-03",79,5,2,0,23,3,2,0,56,2,0,0],["2024-10-04",60,7,2,0,17,2,1,0,43,5,1,0],["2024-10-05",37,6,2,1,13,2,0,0,24,4,2,1],["2024-10-06",37,6,0,0,22,3,0,0,15,3,0,0],["2024-10-07",79,8,3,1,24,3,2,1,55,5,1,0],["2024-10-08",75,11,4,1,16,6,3,0,59,5,1,1],["2024-10-09",72,13,3,0,21,6,1,0,51,7,2,0],["2024-10-10",58,10,2,1,14,2,1,1,44,8,1,0],["2024-10-11",78,12,4,1,29,4,2,1,49,8,2,0],["2024-10-12",35,6,0,0,14,5,0,0,21,1,0,0],["2024-10-13",58,6,0,0,21,3,0,0,37,3,0,0],["2024-10-14",77,9,5,1,23,1,1,0,54,8,4,1],["2024-10-15",89,13,3,1,27,6,2,1,62,7,1,0],["2024-10-16",81,10,1,0,20,5,0,0,61,5,1,0],["2024-10-17",84,14,2,1,23,6,1,0,61,8,1,1],["2024-10-18",54,7,1,0,18,2,0,0,36,5,1,0],["2024-10-19",38,4,1,0,16,2,1,0,22,2,0,0],["2024-10-20",40,3,0,0,20,2,0,0,20,1,0,0],["2024-10-21",74,5,1,0,16,1,0,0,58,4,1,0],["2024-10-22",111,10,1,1,29,5,0,0,82,5,1,1],["2024-10-23",194,24,10,0,103,9,2,0,91,15,8,0],["2024-10-24",156,22,3,1,88,15,1,1,68,7,2,0],["2024-10-25",709,66,10,5,616,54,6,4,93,12,4,1],["2024-10-26",475,22,1,0,435,18,1,0,40,4,0,0],["2024-10-27",77,18,6,3,54,11,4,2,23,7,2,1],["2024-10-28",425,42,9,4,342,30,4,2,83,12,5,2],["2024-10-29",362,45,3,0,280,25,0,0,82,20,3,0],["2024-10-30",350,39,5,1,264,21,2,1,86,18,3,0],["2024-10-31",443,20,3,1,258,8,1,1,185,12,2,0],["2024-11-01",120,20,4,2,74,11,3,2,46,9,1,0],["2024-11-02",87,10,1,1,61,7,1,1,26,3,0,0],["2024-11-03",71,8,2,1,48,8,2,1,23,0,0,0],["2024-11-04",397,33,6,2,306,24,3,1,91,9,3,1],["2024-11-05",367,26,2,0,281,16,0,0,86,10,2,0],["2024-11-06",444,33,5,0,303,23,2,0,141,10,3,0],["2024-11-07",453,33,8,3,342,23,5,2,111,10,3,1],["2024-11-08",493,39,6,3,369,22,3,3,124,17,3,0],["2024-11-09",472,46,6,4,411,34,4,2,61,12,2,2],["2024-11-10",1009,37,4,2,932,30,4,2,77,7,0,0],["2024-11-11",881,55,8,3,777,41,6,3,104,14,2,0],["2024-11-12",968,42,2,2,843,31,2,2,125,11,0,0],["2024-11-13",478,46,9,4,373,31,6,3,105,15,3,1],["2024-11-14",398,34,4,2,311,24,3,2,87,10,1,0],["2024-11-15",350,28,6,3,267,23,3,3,83,5,3,0],["2024-11-16",449,23,1,0,406,19,0,0,43,4,1,0],["2024-11-17",403,37,5,1,341,29,5,1,62,8,0,0],["2024-11-18",348,38,11,5,272,24,6,3,76,14,5,2],["2024-11-19",285,24,5,2,201,15,4,2,84,9,1,0],["2024-11-20",429,40,8,4,307,31,5,3,122,9,3,1],["2024-11-21",386,39,6,3,302,31,3,2,84,8,3,1],["2024-11-22",265,40,7,3,209,30,5,3,56,10,2,0],["2024-11-23",477,35,3,2,438,29,3,2,39,6,0,0],["2024-11-24",298,32,8,7,261,24,7,6,37,8,1,1],["2024-11-25",308,41,6,1,216,24,3,1,92,17,3,0],["2024-11-26",368,36,6,0,294,28,2,0,74,8,4,0],["2024-11-27",349,40,13,6,287,27,9,5,62,13,4,1],["2024-11-28",307,31,8,1,266,25,6,1,41,6,2,0],["2024-11-29",305,40,5,2,236,23,2,0,69,17,3,2],["2024-11-30",374,44,3,2,334,33,3,2,40,11,0,0],["2024-12-01",339,35,5,2,293,30,3,2,46,5,2,0],["2024-12-02",365,35,7,5,295,24,5,5,70,11,2,0],["2024-12-03",421,27,7,4,334,14,2,1,87,13,5,3],["2024-12-04",547,59,14,8,427,40,11,7,120,19,3,1],["2024-12-05",379,46,3,2,285,30,2,1,94,16,1,1],["2024-12-06",676,38,9,4,575,25,6,2,101,13,3,2],["2024-12-07",431,32,6,4,366,28,6,4,65,4,0,0],["2024-12-08",616,41,8,6,549,36,7,5,67,5,1,1],["2024-12-09",505,52,5,2,394,38,4,1,111,14,1,1],["2024-12-10",545,66,11,4,447,56,9,4,98,10,2,0],["2024-12-11",1408,106,16,5,1233,87,11,3,175,19,5,2],["2024-12-12",1886,117,19,9,1773,106,16,6,113,11,3,3],["2024-12-13",703,56,8,1,624,44,4,1,79,12,4,0],["2024-12-14",1947,119,8,2,1799,103,7,2,148,16,1,0],["2024-12-15",1297,74,11,6,1180,54,10,5,117,20,1,1],["2024-12-16",950,85,13,4,802,57,6,3,148,28,7,1],["2024-12-17",1871,112,15,5,1752,109,12,4,119,3,3,1],["2024-12-18",1365,103,19,7,1256,89,17,6,109,14,2,1],["2024-12-19",810,62,9,3,715,53,8,3,95,9,1,0],["2024-12-20",1884,113,16,8,1790,102,11,5,94,11,5,3],["2024-12-21",1004,78,8,3,943,70,8,3,61,8,0,0],["2024-12-22",707,64,10,3,653,58,9,3,54,6,1,0],["2024-12-23",572,46,7,2,519,38,4,1,53,8,3,1],["2024-12-24",350,33,3,0,308,25,1,0,42,8,2,0],["2024-12-25",384,29,2,1,343,21,2,1,41,8,0,0],["2024-12-26",377,34,8,3,330,30,7,3,47,4,1,0],["2024-12-27",404,34,4,4,358,29,3,3,46,5,1,1],["2024-12-28",499,43,2,3,460,37,1,2,39,6,1,1],["2024-12-29",436,36,6,2,376,26,3,1,60,10,3,1],["2024-12-30",408,42,12,4,344,31,11,3,64,11,1,1],["2024-12-31",417,41,6,3,374,35,6,3,43,6,0,0],["2025-01-01",592,45,4,1,531,35,3,1,61,10,1,0],["2025-01-02",510,42,12,5,425,30,6,2,85,12,6,3],["2025-01-03",605,57,11,6,521,45,8,4,84,12,3,2],["2025-01-04",638,44,6,4,584,36,4,3,54,8,2,1],["2025-01-05",563,52,13,8,493,42,10,6,70,10,3,2],["2025-01-06",561,53,15,5,481,40,13,5,80,13,2,0],["2025-01-07",459,46,7,2,360,33,5,2,99,13,2,0],["2025-01-08",618,44,15,7,519,36,13,7,99,8,2,0],["2025-01-09",1024,87,18,9,911,64,13,7,113,23,5,2],["2025-01-10",971,75,12,3,887,64,8,3,84,11,4,0],["2025-01-11",848,76,8,3,774,63,7,3,74,13,1,0],["2025-01-12",772,69,6,4,706,59,5,4,66,10,1,0],["2025-01-13",606,60,9,2,514,41,4,2,92,19,5,0],["2025-01-14",544,86,15,5,439,62,11,3,105,24,4,2],["2025-01-15",584,84,23,12,462,57,12,8,122,27,11,4],["2025-01-16",809,87,16,10,658,67,11,7,151,20,5,3],["2025-01-17",575,84,11,5,440,45,5,3,135,39,6,2],["2025-01-18",881,80,17,8,794,56,11,6,87,24,6,2],["2025-01-19",765,67,14,7,706,55,11,5,59,12,3,2],["2025-01-20",733,74,9,1,609,56,8,0,124,18,1,1],["2025-01-21",789,94,18,10,680,72,11,6,109,22,7,4],["2025-01-22",1213,85,10,3,1062,59,7,2,151,26,3,1],["2025-01-23",920,84,20,8,827,67,13,6,93,17,7,2],["2025-01-24",678,104,22,10,577,83,17,8,101,21,5,2],["2025-01-25",765,115,19,12,641,87,13,9,124,28,6,3],["2025-01-26",728,113,22,13,634,94,17,10,94,19,5,3],["2025-01-27",1116,130,21,7,972,101,18,6,144,29,3,1],["2025-01-28",2042,208,33,15,1827,168,22,12,215,40,11,3],["2025-01-29",1803,216,46,24,1597,177,40,20,206,39,6,4],["2025-01-30",1749,160,29,12,1598,132,23,10,151,28,6,2],["2025-01-31",2175,168,18,7,1974,134,14,5,201,34,4,2],["2025-02-01",2720,216,29,12,2541,189,24,9,179,27,5,3],["2025-02-02",2092,155,24,9,1971,142,22,9,121,13,2,0],["2025-02-03",2057,175,34,14,1916,159,30,14,141,16,4,0],["2025-02-04",1909,169,31,14,1771,144,27,13,138,25,4,1],["2025-02-05",1896,155,23,11,1745,128,18,8,151,27,5,3],["2025-02-06",1654,147,23,12,1485,122,20,11,169,25,3,1],["2025-02-07",1150,132,25,8,997,98,19,6,153,34,6,2],["2025-02-08",1069,118,16,8,932,97,14,7,137,21,2,1],["2025-02-09",910,92,18,4,797,74,15,4,113,18,3,0],["2025-02-10",963,133,25,12,804,100,16,7,159,33,9,5],["2025-02-11",1049,109,29,14,890,83,17,10,159,26,12,4],["2025-02-12",1274,134,28,12,1110,108,27,11,164,26,1,1],["2025-02-13",878,83,19,13,756,62,15,10,122,21,4,3],["2025-02-14",1267,108,12,2,1136,87,12,2,131,21,0,0],["2025-02-15",1403,104,20,10,1329,97,17,7,74,7,3,3],["2025-02-16",943,93,17,6,866,85,13,6,77,8,4,0],["2025-02-17",766,82,16,7,615,60,10,6,151,22,6,1],["2025-02-18",1442,248,50,21,900,101,26,11,542,147,24,10],["2025-02-19",1399,273,57,22,900,130,30,11,499,143,27,11],["2025-02-20",1662,229,45,20,1204,109,18,6,458,120,27,14],["2025-02-21",1830,245,46,21,1303,130,23,10,527,115,23,11],["2025-02-22",1234,168,41,19,909,98,24,11,325,70,17,8],["2025-02-23",1249,182,31,15,959,105,24,12,290,77,7,3],["2025-02-24",1148,176,50,23,754,86,25,11,394,90,25,12],["2025-02-25",1034,138,32,17,785,92,22,13,249,46,10,4],["2025-02-26",826,87,30,12,670,72,23,8,156,15,7,4],["2025-02-27",834,78,21,12,658,62,16,10,176,16,5,2],["2025-02-28",745,70,16,8,639,57,12,7,106,13,4,1],["2025-03-01",820,78,21,13,706,61,18,11,114,17,3,2],["2025-03-02",658,92,30,18,577,78,25,15,81,14,5,3],["2025-03-03",767,93,20,15,614,79,19,14,153,14,1,1],["2025-03-04",962,96,24,16,775,72,20,13,187,24,4,3],["2025-03-05",813,80,22,14,671,59,16,10,142,21,6,4],["2025-03-06",1022,120,34,19,826,97,26,16,196,23,8,3],["2025-03-07",1018,155,36,26,817,125,31,25,201,30,5,1],["2025-03-08",785,148,33,22,648,120,26,18,137,28,7,4],["2025-03-09",888,152,42,28,780,128,35,23,108,24,7,5],["2025-03-10",1157,180,56,32,926,144,44,27,231,36,12,5],["2025-03-11",1055,168,55,35,868,134,41,26,187,34,14,9],["2025-03-12",872,137,40,22,683,108,31,18,189,29,9,4],["2025-03-13",821,190,56,35,631,144,42,29,190,46,14,6],["2025-03-14",912,206,51,30,705,165,44,27,207,41,7,3],["2025-03-15",718,204,59,43,622,176,50,35,96,28,9,8],["2025-03-16",950,204,51,28,833,174,44,25,117,30,7,3],["2025-03-17",1007,240,57,37,818,190,41,29,189,50,16,8],["2025-03-18",748,193,58,41,604,160,46,37,144,33,12,4],["2025-03-19",716,228,69,50,557,186,50,40,159,42,19,10],["2025-03-20",698,187,56,33,526,150,43,26,172,37,13,7],["2025-03-21",620,142,42,29,468,113,32,22,152,29,10,7],["2025-03-22",613,155,47,24,498,140,40,21,115,15,7,3],["2025-03-23",571,140,28,20,481,114,21,14,90,26,7,6],["2025-03-24",696,158,46,30,537,127,36,25,159,31,10,5],["2025-03-25",711,175,52,29,529,128,39,23,182,47,13,6],["2025-03-26",563,137,37,23,412,101,30,20,151,36,7,3],["2025-03-27",573,123,40,16,417,97,31,13,156,26,9,3],["2025-03-28",542,134,40,22,414,115,34,20,128,19,6,2],["2025-03-29",432,87,27,13,358,74,23,11,74,13,4,2],["2025-03-30",435,96,29,17,372,85,27,16,63,11,2,1],["2025-03-31",641,126,35,21,500,105,30,19,141,21,5,2],["2025-04-01",752,128,33,14,571,99,26,13,181,29,7,1],["2025-04-02",572,146,43,21,420,116,36,19,152,30,7,2],["2025-04-03",683,177,43,20,487,145,32,18,196,32,11,2],["2025-04-04",586,138,31,20,414,110,20,12,172,28,11,8],["2025-04-05",450,151,41,19,382,128,36,17,68,23,5,2],["2025-04-06",420,127,36,20,346,108,31,17,74,19,5,3],["2025-04-07",568,178,56,33,409,153,44,27,159,25,12,6],["2025-04-08",639,193,49,23,478,163,39,20,161,30,10,3],["2025-04-09",510,154,58,30,351,116,41,24,159,38,17,6],["2025-04-10",511,134,54,27,369,106,44,24,142,28,10,3],["2025-04-11",481,134,48,26,366,106,41,23,115,28,7,3],["2025-04-12",379,113,36,22,316,97,31,20,63,16,5,2],["2025-04-13",409,110,43,25,333,90,37,22,76,20,6,3],["2025-04-14",710,148,48,26,498,108,37,21,212,40,11,5],["2025-04-15",478,135,52,33,359,112,45,31,119,23,7,2],["2025-04-16",550,137,42,23,376,96,32,18,174,41,10,5],["2025-04-17",544,115,37,18,410,95,35,17,134,20,2,1],["2025-04-18",445,118,38,20,318,89,29,17,127,29,9,3],["2025-04-19",342,100,31,16,277,84,27,15,65,16,4,1],["2025-04-20",375,97,33,18,314,79,28,16,61,18,5,2],["2025-04-21",758,199,80,40,472,135,53,28,286,64,27,12],["2025-04-22",676,175,61,27,425,117,49,22,251,58,12,5],["2025-04-23",553,137,50,22,370,96,37,18,183,41,13,4],["2025-04-24",594,126,41,20,369,81,28,15,225,45,13,5],["2025-04-25",490,114,43,18,335,81,31,14,155,33,12,4],["2025-04-26",352,85,23,11,297,71,20,10,55,14,3,1],["2025-04-27",409,95,28,13,320,79,23,13,89,16,5,0],["2025-04-28",571,124,45,19,383,97,37,15,188,27,8,4],["2025-04-29",518,137,46,20,371,113,39,18,147,24,7,2],["2025-04-30",471,99,38,21,347,84,30,21,124,15,8,0],["2025-05-01",430,82,44,22,320,66,37,18,110,16,7,4],["2025-05-02",443,106,38,16,338,81,31,15,105,25,7,1],["2025-05-03",356,103,27,12,297,86,23,11,59,17,4,1],["2025-05-04",366,89,38,21,315,73,31,18,51,16,7,3],["2025-05-05",467,128,54,23,333,97,39,18,134,31,15,5],["2025-05-06",481,119,39,20,348,83,29,15,133,36,10,5],["2025-05-07",790,254,96,37,484,164,59,23,306,90,37,14],["2025-05-08",693,198,79,32,430,128,54,21,263,70,25,11],["2025-05-09",574,148,38,20,369,101,24,13,205,47,14,7],["2025-05-10",374,101,33,18,286,74,26,16,88,27,7,2],["2025-05-11",344,78,21,10,259,56,16,8,85,22,5,2],["2025-05-12",706,187,75,33,446,135,52,24,260,52,23,9],["2025-05-13",610,159,49,24,397,114,34,20,213,45,15,4],["2025-05-14",607,162,53,33,368,93,32,19,239,69,21,14],["2025-05-15",1043,140,46,15,592,97,29,10,451,43,17,5],["2025-05-16",654,140,47,21,427,96,33,17,227,44,14,4],["2025-05-17",482,119,32,20,378,98,24,16,104,21,8,4],["2025-05-18",535,142,47,27,454,122,44,24,81,20,3,3],["2025-05-19",618,150,54,28,405,106,39,22,213,44,15,6],["2025-05-20",507,127,61,30,355,105,52,26,152,22,9,4],["2025-05-21",575,136,54,29,413,109,45,25,162,27,9,4],["2025-05-22",645,129,50,26,437,99,38,20,208,30,12,6],["2025-05-23",563,130,60,34,408,107,46,26,155,23,14,8],["2025-05-24",460,120,45,21,375,100,38,18,85,20,7,3],["2025-05-25",486,138,50,20,396,113,44,19,90,25,6,1],["2025-05-26",559,125,51,24,441,105,42,22,118,20,9,2],["2025-05-27",965,178,68,27,733,138,54,21,232,40,14,6],["2025-05-28",1019,168,61,29,809,131,45,24,210,37,16,5],["2025-05-29",1158,214,151,113,849,155,105,78,309,59,46,35],["2025-05-30",1094,204,80,37,821,160,56,27,273,44,24,10],["2025-05-31",807,156,70,38,645,123,53,28,162,33,17,10],["2025-06-01",668,153,54,24,549,130,45,20,119,23,9,4],["2025-06-02",937,181,82,39,650,140,59,26,287,41,23,13],["2025-06-03",893,167,61,26,640,126,37,18,253,41,24,8],["2025-06-04",819,159,76,42,579,110,52,29,240,49,24,13],["2025-06-05",691,169,65,28,496,122,43,17,195,47,22,11],["2025-06-06",768,148,55,25,557,111,39,20,211,37,16,5],["2025-06-07",496,123,47,25,419,99,40,22,77,24,7,3],["2025-06-08",582,140,55,28,480,118,47,24,102,22,8,4],["2025-06-09",722,152,61,30,555,120,45,25,167,32,16,5],["2025-06-10",689,135,64,28,471,103,50,27,218,32,14,1],["2025-06-11",701,190,67,35,490,154,54,31,211,36,13,4],["2025-06-12",660,184,73,34,448,151,66,30,212,33,7,4],["2025-06-13",624,143,60,28,423,100,46,25,201,43,14,3],["2025-06-14",487,118,46,30,424,103,43,29,63,15,3,1],["2025-06-15",479,127,51,31,399,101,39,23,80,26,12,8],["2025-06-16",643,150,63,26,458,117,52,21,185,33,11,5],["2025-06-17",801,216,103,58,559,176,92,51,242,40,11,7],["2025-06-18",788,177,118,70,524,126,84,49,264,51,34,21],["2025-06-19",613,170,93,50,418,126,68,36,195,44,25,14],["2025-06-20",590,117,49,20,391,75,32,14,199,42,17,6],["2025-06-21",358,89,45,20,296,75,38,18,62,14,7,2],["2025-06-22",407,109,48,24,315,94,42,20,92,15,6,4],["2025-06-23",722,152,68,33,441,110,50,24,281,42,18,9],["2025-06-24",620,136,55,25,389,103,36,17,231,33,19,8],["2025-06-25",703,136,64,29,468,83,41,19,235,53,23,10],["2025-06-26",615,127,61,36,425,91,46,26,190,36,15,10],["2025-06-27",635,127,75,37,434,94,57,32,201,33,18,5],["2025-06-28",390,95,36,14,313,76,30,11,77,19,6,3],["2025-06-29",404,96,38,20,317,83,31,17,87,13,7,3],["2025-06-30",649,121,52,27,410,79,37,19,239,42,15,8],["2025-07-01",591,124,56,31,369,86,36,20,222,38,20,11],["2025-07-02",562,115,55,30,338,81,40,21,224,34,15,9],["2025-07-03",499,111,51,29,299,69,37,23,200,42,14,6],["2025-07-04",325,89,34,17,244,65,23,12,81,24,11,5],["2025-07-05",243,60,27,19,197,53,25,19,46,7,2,0],["2025-07-06",207,51,15,8,152,40,10,5,55,11,5,3],["2025-07-07",412,75,36,11,214,53,23,6,198,22,13,5],["2025-07-08",381,71,43,19,204,46,31,13,177,25,12,6],["2025-07-09",435,75,40,20,228,51,25,16,207,24,15,4],["2025-07-10",440,75,21,10,273,57,15,9,167,18,6,1],["2025-07-11",645,120,63,34,445,85,49,24,200,35,14,10],["2025-07-12",441,106,48,28,352,82,34,21,89,24,14,7],["2025-07-13",363,109,44,21,279,84,32,16,84,25,12,5],["2025-07-14",544,134,60,34,340,97,42,22,204,37,18,12],["2025-07-15",602,125,48,15,374,87,33,13,228,38,15,2],["2025-07-16",643,134,69,29,410,87,50,25,233,47,19,4],["2025-07-17",735,167,65,35,510,118,45,26,225,49,20,9],["2025-07-18",605,116,42,24,403,80,32,17,202,36,10,7],["2025-07-19",435,105,40,16,354,86,33,14,81,19,7,2],["2025-07-20",419,100,36,22,314,81,28,17,105,19,8,5],["2025-07-21",578,119,52,25,335,78,37,16,243,41,15,9],["2025-07-22",568,91,49,20,345,59,35,12,223,32,14,8],["2025-07-23",948,135,153,67,606,92,122,52,342,43,31,15],["2025-07-24",700,128,96,44,425,95,67,28,275,33,29,16],["2025-07-25",547,112,47,19,338,82,33,11,209,30,14,8],["2025-07-26",394,108,53,19,293,85,42,17,101,23,11,2],["2025-07-27",379,106,42,24,289,87,33,20,90,19,9,4],["2025-07-28",571,120,46,23,335,89,34,17,236,31,12,6],["2025-07-29",586,124,50,26,346,86,39,20,240,38,11,6],["2025-07-30",575,107,42,25,343,73,25,15,232,34,17,10],["2025-07-31",624,119,54,27,385,93,45,21,239,26,9,6],["2025-08-01",556,103,45,28,326,75,32,11,230,28,13,17],["2025-08-02",399,103,48,20,284,75,37,15,115,28,11,5],["2025-08-03",373,101,31,16,287,86,26,13,86,15,5,3],["2025-08-04",675,140,54,113,437,100,30,9,238,40,24,104],["2025-08-05",659,136,64,141,427,96,45,21,232,40,19,120],["2025-08-06",712,126,55,110,463,93,37,16,249,33,18,94],["2025-08-07",712,116,63,139,473,80,39,22,239,36,24,117],["2025-08-08",685,133,74,82,444,86,45,19,241,47,29,63],["2025-08-09",482,139,69,45,389,110,57,37,93,29,12,8],["2025-08-10",445,114,52,26,339,91,42,21,106,23,10,5],["2025-08-11",608,125,62,108,402,94,46,27,206,31,16,81],["2025-08-12",618,136,64,100,379,81,35,22,239,55,29,78],["2025-08-13",917,166,53,63,587,114,29,12,330,52,24,51],["2025-08-14",669,142,52,82,437,100,34,17,232,42,18,65],["2025-08-15",649,120,54,24,469,88,40,19,180,32,14,5],["2025-08-16",457,96,33,19,374,90,31,19,83,6,2,0],["2025-08-17",490,96,25,9,416,83,23,8,74,13,2,1],["2025-08-18",840,199,106,58,554,137,70,43,286,62,36,15],["2025-08-19",731,151,79,41,476,109,52,29,255,42,27,12],["2025-08-20",793,173,94,53,532,125,63,32,261,48,31,21],["2025-08-21",848,199,101,52,578,131,69,38,270,68,32,14],["2025-08-22",643,116,67,44,436,89,49,33,207,27,18,11],["2025-08-23",518,137,83,50,405,107,62,38,113,30,21,12],["2025-08-24",450,113,43,20,356,84,29,14,94,29,14,6],["2025-08-25",753,133,82,64,476,93,47,25,277,40,35,39],["2025-08-26",845,240,110,70,523,155,70,42,322,85,40,28],["2025-08-27",634,148,66,48,408,109,47,31,226,39,19,17],["2025-08-28",689,163,60,32,475,139,51,29,214,24,9,3],["2025-08-29",621,135,62,39,421,104,43,24,200,31,19,15],["2025-08-30",505,126,40,24,384,104,33,20,121,22,7,4],["2025-08-31",419,104,37,18,343,91,28,14,76,13,9,4],["2025-09-01",498,115,50,34,381,94,35,18,117,21,15,16],["2025-09-02",643,96,40,34,425,75,28,18,218,21,12,16],["2025-09-03",657,116,61,43,436,83,32,18,221,33,29,25],["2025-09-04",623,131,51,19,405,99,34,12,218,32,17,7],["2025-09-05",690,119,81,42,440,90,55,32,250,29,26,10],["2025-09-06",516,100,59,33,391,84,45,25,125,16,14,8],["2025-09-07",444,94,45,30,355,80,38,26,89,14,7,4],["2025-09-08",739,119,52,22,506,87,38,18,233,32,14,4],["2025-09-09",683,114,44,21,458,86,32,19,225,28,12,2],["2025-09-10",613,115,54,30,421,81,38,24,192,34,16,6],["2025-09-11",574,115,55,31,391,77,39,21,183,38,16,10],["2025-09-12",682,117,53,27,456,99,41,22,226,18,12,5],["2025-09-13",500,92,35,19,398,74,33,18,102,18,2,1],["2025-09-14",575,128,46,24,475,103,38,21,100,25,8,3],["2025-09-15",635,123,46,31,457,83,34,26,178,40,12,5],["2025-09-16",646,143,55,31,453,106,42,26,193,37,13,5],["2025-09-17",656,138,64,33,489,102,47,29,167,36,17,4],["2025-09-18",677,130,51,34,464,102,41,29,213,28,10,5],["2025-09-19",598,106,51,27,401,69,31,19,197,37,20,8],["2025-09-20",419,100,46,25,351,74,31,17,68,26,15,8],["2025-09-21",539,129,50,31,434,115,39,25,105,14,11,6],["2025-09-22",759,137,60,33,506,104,40,21,253,33,20,12],["2025-09-23",887,188,74,41,561,122,51,31,326,66,23,10],["2025-09-24",881,164,95,64,545,105,67,47,336,59,28,17],["2025-09-25",751,168,87,62,473,110,59,45,278,58,28,17],["2025-09-26",779,135,47,43,504,96,28,33,275,39,19,10],["2025-09-27",659,169,85,51,452,137,70,46,207,32,15,5],["2025-09-28",584,141,60,38,468,117,50,31,116,24,10,7],["2025-09-29",776,174,81,50,493,116,50,31,283,58,31,19],["2025-09-30",765,190,71,38,506,131,49,23,259,59,22,15],["2025-10-01",703,167,69,72,459,123,54,67,244,44,15,5],["2025-10-02",813,161,90,51,525,122,72,44,288,39,18,7],["2025-10-03",806,132,75,37,556,98,52,27,250,34,23,10],["2025-10-04",566,113,56,34,475,94,51,30,91,19,5,4],["2025-10-05",580,134,77,47,457,104,57,33,123,30,20,14],["2025-10-06",763,143,73,36,531,102,52,28,232,41,21,8],["2025-10-07",648,125,58,35,456,92,39,23,192,33,19,12],["2025-10-08",769,130,57,33,518,96,44,23,251,34,13,10],["2025-10-09",911,151,166,109,621,110,128,85,290,41,38,24],["2025-10-10",829,118,87,47,582,79,58,34,247,39,29,13],["2025-10-11",542,89,46,28,425,67,32,19,117,22,14,9],["2025-10-12",573,110,60,35,468,85,46,28,105,25,14,7],["2025-10-13",715,109,60,33,476,75,46,28,239,34,14,5],["2025-10-14",885,146,73,40,645,110,59,34,240,36,14,6],["2025-10-15",891,142,76,40,629,101,58,31,262,41,18,9],["2025-10-16",970,158,61,34,674,105,45,25,296,53,16,9],["2025-10-17",980,115,105,64,720,83,76,47,260,32,29,17],["2025-10-18",653,104,76,39,497,82,50,26,156,22,26,13],["2025-10-19",588,99,52,27,476,75,41,24,112,24,11,3],["2025-10-20",996,183,85,56,715,148,68,46,281,35,17,10],["2025-10-21",980,221,94,51,653,168,74,40,327,53,20,11],["2025-10-22",943,228,110,58,682,170,82,45,261,58,28,13],["2025-10-23",867,183,65,35,637,145,51,29,230,38,14,6],["2025-10-24",799,171,67,33,584,129,51,25,215,42,16,8],["2025-10-25",693,137,67,35,558,107,50,26,135,30,17,9],["2025-10-26",672,144,67,36,540,110,53,26,132,34,14,10],["2025-10-27",958,211,83,43,664,157,61,34,294,54,22,9],["2025-10-28",1007,221,77,40,713,164,55,32,294,57,22,8],["2025-10-29",1042,172,74,39,752,130,59,32,290,42,15,7],["2025-10-30",849,124,45,23,617,93,33,16,232,31,12,7],["2025-10-31",765,139,52,26,554,104,41,20,211,35,11,6],["2025-11-01",769,115,37,23,623,96,29,19,146,19,8,4],["2025-11-02",840,125,38,17,675,107,33,16,165,18,5,1],["2025-11-03",878,140,56,29,616,101,37,22,262,39,19,7],["2025-11-04",764,128,51,25,551,87,34,17,213,41,17,8],["2025-11-05",751,123,46,15,495,80,34,13,256,43,12,2],["2025-11-06",866,136,71,32,623,92,47,24,243,44,24,8],["2025-11-07",779,117,52,23,562,97,43,17,217,20,9,6],["2025-11-08",641,102,51,23,511,78,41,19,130,24,10,4],["2025-11-09",606,109,48,27,489,90,42,23,117,19,6,4],["2025-11-10",661,101,49,30,480,74,37,24,181,27,12,6],["2025-11-11",582,90,44,18,405,64,37,13,177,26,7,5],["2025-11-12",573,78,40,17,419,58,25,11,154,20,15,6],["2025-11-13",594,108,47,23,432,90,37,19,162,18,10,4],["2025-11-14",605,113,49,27,411,75,31,18,194,38,18,9],["2025-11-15",437,104,42,25,372,85,31,18,65,19,11,7],["2025-11-16",568,133,59,21,468,111,49,18,100,22,10,3],["2025-11-17",745,193,105,55,535,154,79,41,210,39,26,14],["2025-11-18",784,283,128,58,609,244,107,49,175,39,21,9],["2025-11-19",747,211,96,48,538,173,74,40,209,38,22,8],["2025-11-20",714,156,81,26,470,123,58,20,244,33,23,6],["2025-11-21",783,255,126,38,567,207,97,25,216,48,29,13],["2025-11-22",666,275,125,47,550,235,101,35,116,40,24,12],["2025-11-23",630,238,109,32,508,203,85,27,122,35,24,5],["2025-11-24",672,230,92,29,457,185,67,22,215,45,25,7],["2025-11-25",591,189,76,36,387,147,59,29,204,42,17,7],["2025-11-26",535,168,72,25,392,144,59,19,143,24,13,6],["2025-11-27",309,89,39,15,245,78,33,13,64,11,6,2],["2025-11-28",395,150,83,32,301,129,63,20,94,21,20,12],["2025-11-29",388,196,114,52,299,168,92,44,89,28,22,8],["2025-11-30",393,180,91,40,276,145,69,29,117,35,22,11],["2025-12-01",530,172,84,35,354,129,62,27,176,43,22,8],["2025-12-02",741,170,78,32,516,131,56,20,225,39,22,12],["2025-12-03",488,132,67,30,310,106,51,20,178,26,16,10],["2025-12-04",512,104,47,16,323,75,32,9,189,29,15,7],["2025-12-05",587,158,73,23,389,126,51,17,198,32,22,6],["2025-12-06",536,199,98,41,410,171,78,30,126,28,20,11],["2025-12-07",502,179,83,35,394,156,68,28,108,23,15,7],["2025-12-08",761,232,107,35,500,188,83,29,261,44,24,6],["2025-12-09",1198,299,125,46,687,236,104,33,511,63,21,13],["2025-12-10",1059,266,122,43,603,207,88,31,456,59,34,12],["2025-12-11",796,211,91,49,506,168,69,40,290,43,22,9],["2025-12-12",838,181,59,24,465,139,47,18,373,42,12,6],["2025-12-13",499,132,60,20,358,106,50,16,141,26,10,4],["2025-12-14",508,135,57,31,374,106,41,22,134,29,16,9],["2025-12-15",823,156,73,31,496,114,50,22,327,42,23,9],["2025-12-16",674,135,47,25,428,99,34,16,246,36,13,9],["2025-12-17",697,128,53,21,453,85,37,14,244,43,16,7],["2025-12-18",335,52,25,15,155,30,15,10,180,22,10,5],["2025-12-19",317,53,24,10,186,42,19,6,131,11,5,4],["2025-12-20",163,50,21,6,114,41,18,6,49,9,3,0],["2025-12-21",166,42,14,3,104,36,12,3,62,6,2,0],["2025-12-22",287,47,19,9,143,34,13,5,144,13,6,4],["2025-12-23",265,41,16,7,142,29,9,6,123,12,7,1],["2025-12-24",134,29,14,6,81,19,6,3,53,10,8,3],["2025-12-25",127,22,11,4,79,15,7,2,48,7,4,2],["2025-12-26",220,29,18,6,123,18,8,2,97,11,10,4],["2025-12-27",184,21,10,4,111,19,8,3,73,2,2,1],["2025-12-28",156,22,7,4,86,16,1,0,70,6,6,4],["2025-12-29",270,33,20,12,139,25,13,8,131,8,7,4],["2025-12-30",256,30,27,14,128,20,15,6,128,10,12,8],["2025-12-31",157,23,17,2,79,14,11,1,78,9,6,1],["2026-01-01",117,17,14,3,71,15,12,2,46,2,2,1],["2026-01-02",139,18,10,5,79,13,6,3,60,5,4,2],["2026-01-03",100,13,11,1,55,9,9,0,45,4,2,1],["2026-01-04",93,19,7,1,56,14,7,1,37,5,0,0],["2026-01-05",216,24,13,4,83,13,8,4,133,11,5,0],["2026-01-06",192,29,22,8,68,15,10,6,124,14,12,2],["2026-01-07",214,27,26,7,90,24,19,6,124,3,7,1],["2026-01-08",198,17,11,5,89,9,6,2,109,8,5,3],["2026-01-09",154,16,14,5,53,9,7,2,101,7,7,3],["2026-01-10",66,13,11,5,39,7,8,3,27,6,3,2],["2026-01-11",110,21,17,3,63,12,10,2,47,9,7,1],["2026-01-12",213,19,14,5,73,8,7,3,140,11,7,2],["2026-01-13",179,20,16,5,67,12,6,2,112,8,10,3],["2026-01-14",165,16,9,2,64,11,6,2,101,5,3,0],["2026-01-15",159,20,13,3,68,12,6,2,91,8,7,1],["2026-01-16",498,22,11,2,371,14,9,2,127,8,2,0],["2026-01-17",66,13,12,2,34,9,8,1,32,4,4,1],["2026-01-18",76,15,11,3,40,11,8,1,36,4,3,2],["2026-01-19",208,28,13,0,133,20,11,0,75,8,2,0],["2026-01-20",218,41,23,4,99,27,14,3,119,14,9,1],["2026-01-21",224,20,13,3,89,11,3,1,135,9,10,2],["2026-01-22",235,27,18,4,113,15,10,2,122,12,8,2],["2026-01-23",222,20,13,2,128,8,5,2,94,12,8,0],["2026-01-24",158,23,14,3,120,21,9,2,38,2,5,1],["2026-01-25",115,13,9,4,66,9,6,3,49,4,3,1],["2026-01-26",344,45,37,10,192,22,21,4,152,23,16,6],["2026-01-27",444,26,23,9,253,5,7,3,191,21,16,6],["2026-01-28",371,24,24,5,164,12,15,2,207,12,9,3],["2026-01-29",207,23,12,2,112,15,9,2,95,8,3,0],["2026-01-30",243,21,24,10,138,14,18,8,105,7,6,2],["2026-01-31",112,8,11,0,69,6,8,0,43,2,3,0],["2026-02-01",113,9,5,1,81,5,4,0,32,4,1,1],["2026-02-02",221,16,9,0,109,8,6,0,112,8,3,0],["2026-02-03",296,19,13,2,170,5,4,2,126,14,9,0],["2026-02-04",207,27,18,8,108,15,10,4,99,12,8,4],["2026-02-05",231,21,23,2,97,10,17,2,134,11,6,0],["2026-02-06",198,16,16,5,96,8,11,2,102,8,5,3],["2026-02-07",83,8,15,3,58,5,12,3,25,3,3,0],["2026-02-08",105,7,12,1,65,4,10,1,40,3,2,0],["2026-02-09",241,20,16,6,102,4,7,1,139,16,9,5],["2026-02-10",234,18,19,4,118,6,11,3,116,12,8,1],["2026-02-11",221,32,22,6,104,14,11,1,117,18,11,5],["2026-02-12",214,18,18,8,100,9,10,2,114,9,8,6],["2026-02-13",190,23,16,5,101,10,10,2,89,13,6,3],["2026-02-14",79,12,11,2,50,8,7,2,29,4,4,0]];

// ===== DATA LOADING =====
async function loadData(){
  document.getElementById('syncStatus').textContent='Loading...';
  let allC=[],allM=[],from=0;
  while(true){const{data}=await sb.from('growth_contacts').select('*').range(from,from+999);if(!data||!data.length)break;allC=allC.concat(data);if(data.length<1000)break;from+=1000;}
  from=0;
  while(true){const{data}=await sb.from('growth_meetings').select('*').range(from,from+999);if(!data||!data.length)break;allM=allM.concat(data);if(data.length<1000)break;from+=1000;}
  contacts=allC;meetings=allM;
  document.getElementById('syncStatus').textContent=`${contacts.length.toLocaleString()} contacts ¬∑ ${meetings.length.toLocaleString()} meetings`;
  populateSourceFilter();refresh();
}
function populateSourceFilter(){
  const s=new Set();contacts.forEach(c=>{if(c.attributed_source)s.add(c.attributed_source)});
  const sources=[...s].sort();
  const filtered=metricScope==='marketing'?sources.filter(v=>MARKETING_SOURCES.includes(v)):sources;
  const sel=document.getElementById('sourceFilter');
  const cur=sel.value;
  sel.innerHTML='<option value="all">All Sources</option>'+filtered.map(v=>`<option value="${v}">${sourceLabel(v)}</option>`).join('');
  if(filtered.includes(cur))sel.value=cur;else sel.value='all';
}
function sourceLabel(v){return v||'Unknown';}

// ===== SYNC =====
async function callFunc(b){return(await fetch(FUNC_URL,{method:'POST',headers:{'Content-Type':'application/json','Authorization':'Bearer '+SB_KEY},body:JSON.stringify(b)})).json()}
async function runSync(){
  const btn=document.getElementById('syncBtn'),ov=document.getElementById('syncOverlay'),pr=document.getElementById('syncProgress'),dt=document.getElementById('syncDetail'),bar=document.getElementById('syncBar');
  btn.classList.add('syncing');btn.disabled=true;ov.classList.add('show');
  try{
    pr.textContent='Step 1/3: Fetching contact list...';dt.textContent='Getting contact IDs';bar.style.width='10%';
    const lr=await callFunc({step:'list'});if(!lr.success)throw new Error(lr.error);
    const tot=lr.contact_ids_fetched||0;pr.textContent=`Step 2/3: Syncing ${tot.toLocaleString()} contacts...`;bar.style.width='20%';
    let bs=0,ts=0,done=false;
    while(!done){dt.textContent=`Batch ${bs.toLocaleString()}/${tot.toLocaleString()}`;bar.style.width=(20+(bs/Math.max(tot,1))*50)+'%';
      const cr=await callFunc({step:'contacts',batch_start:bs});if(!cr.success)throw new Error(cr.error);ts+=cr.contacts_synced||0;done=cr.complete;
      if(!done){const m=cr.progress?.match(/^(\d+)/);bs=m?parseInt(m[1]):bs+10000;}}
    pr.textContent='Step 3/3: Syncing meetings...';dt.textContent=`${ts.toLocaleString()} contacts done`;bar.style.width='80%';
    const mr=await callFunc({step:'meetings'});bar.style.width='100%';pr.textContent='Sync complete!';
    dt.textContent=`${ts.toLocaleString()} contacts ¬∑ ${(mr.meetings_synced||0).toLocaleString()} meetings`;
    await new Promise(r=>setTimeout(r,1500));await loadData();
  }catch(e){pr.textContent='Sync error';dt.textContent=e.message;await new Promise(r=>setTimeout(r,3000));}
  finally{ov.classList.remove('show');btn.classList.remove('syncing');btn.disabled=false;bar.style.width='0%';}
}

// ===== PERIOD UTILS =====
function getWeekStart(d){const dt=new Date(d);const day=dt.getUTCDay();const diff=day===0?-6:1-day;dt.setUTCDate(dt.getUTCDate()+diff);return new Date(Date.UTC(dt.getUTCFullYear(),dt.getUTCMonth(),dt.getUTCDate()))}
function getPeriodKey(date){const d=new Date(date);if(viewMode==='weekly'){return getWeekStart(d).toISOString().split('T')[0]}return`${d.getUTCFullYear()}-${String(d.getUTCMonth()+1).padStart(2,'0')}`}
function getCurrentPeriodKey(){const now=new Date();if(viewMode==='weekly'){const ws=getWeekStart(now);ws.setUTCDate(ws.getUTCDate()+periodOffset*7);return ws.toISOString().split('T')[0]}const m=now.getUTCMonth()+periodOffset;const y=now.getUTCFullYear()+Math.floor(m/12);const mo=((m%12)+12)%12;return`${y}-${String(mo+1).padStart(2,'0')}`}
function getPrevKey(k){if(viewMode==='weekly'){const d=new Date(k+'T00:00:00Z');d.setUTCDate(d.getUTCDate()-7);return d.toISOString().split('T')[0]}const[y,m]=k.split('-').map(Number);return m-1<1?`${y-1}-12`:`${y}-${String(m-1).padStart(2,'0')}`}
function formatPeriod(k){if(viewMode==='weekly'){const d=new Date(k+'T00:00:00Z');const e=new Date(d);e.setUTCDate(e.getUTCDate()+6);const o={month:'short',day:'numeric',timeZone:'UTC'};return`${d.toLocaleDateString('en-US',o)} ‚Äì ${e.toLocaleDateString('en-US',o)}, ${d.getUTCFullYear()}`}const[y,m]=k.split('-');return new Date(Date.UTC(y,m-1,1)).toLocaleDateString('en-US',{month:'long',year:'numeric',timeZone:'UTC'})}
function formatShort(k){if(viewMode==='weekly'){return new Date(k+'T00:00:00Z').toLocaleDateString('en-US',{month:'short',day:'numeric',timeZone:'UTC'})}const[y,m]=k.split('-');return new Date(Date.UTC(y,m-1,1)).toLocaleDateString('en-US',{month:'short',year:'2-digit',timeZone:'UTC'})}

// ===== FILTERING =====
function filterC(list){
  let f=list;
  if(metricScope==='marketing')f=f.filter(c=>MARKETING_SOURCES.includes(c.attributed_source));
  const sv=document.getElementById('sourceFilter').value;
  if(sv!=='all')f=f.filter(c=>c.attributed_source===sv);
  return f;
}
function setScope(s,btn){metricScope=s;document.querySelectorAll('#scopeToggle button').forEach(b=>b.classList.remove('active'));btn.classList.add('active');populateSourceFilter();refresh();}

// ===== PIPELINE METRICS =====
const MQL_S=['marketingqualifiedlead','salesqualifiedlead','opportunity','99994170','customer'];
const SQL_S=['salesqualifiedlead','opportunity','99994170','customer'];

function filterM(list){
  const sv=document.getElementById('sourceFilter').value;
  if(metricScope==='total'&&sv==='all')return list;
  // Build contact id -> source lookup
  const cMap={};contacts.forEach(c=>{cMap[c.id]=c.attributed_source||null});
  return list.filter(m=>{
    if(!m.contact_id)return false;
    const src=cMap[m.contact_id];
    if(metricScope==='marketing'&&!MARKETING_SOURCES.includes(src))return false;
    if(sv!=='all'&&src!==sv)return false;
    return true;
  });
}

function calcMetrics(pk){
  const fc=filterC(contacts),fm=filterM(meetings);
  return{
    mqls:fc.filter(c=>c.create_date&&getPeriodKey(c.create_date)===pk&&MQL_S.includes(c.lifecycle_stage)).length,
    sqls:fc.filter(c=>c.create_date&&getPeriodKey(c.create_date)===pk&&SQL_S.includes(c.lifecycle_stage)).length,
    mtgs:fm.filter(m=>{const d=m.created_date||m.start_time;return d&&getPeriodKey(d)===pk}).length,
    sits:fm.filter(m=>{if(!m.start_time||getPeriodKey(m.start_time)!==pk)return false;const o=(m.outcome||'').toLowerCase().replace(/[_:]/g,' ');return o.includes('completed')||o.includes('not needed')||o.includes('docs needed')}).length,
    closesCreated:fc.filter(c=>c.lifecycle_stage==='customer'&&c.create_date&&getPeriodKey(c.create_date)===pk).length,
    closesDeal:fc.filter(c=>c.recent_deal_close_date&&getPeriodKey(c.recent_deal_close_date)===pk&&c.lifecycle_stage==='customer').length
  };
}

function calcBySource(pk){
  let fc=contacts;if(metricScope==='marketing')fc=fc.filter(c=>MARKETING_SOURCES.includes(c.attributed_source));
  const cMap={};fc.forEach(c=>{cMap[c.id]=c.attributed_source||'Unknown'});
  const out={};
  fc.forEach(c=>{const s=c.attributed_source||'Unknown';if(!out[s])out[s]={mqls:0,sqls:0,closes:0,mtgs:0,sits:0};
    if(c.create_date&&getPeriodKey(c.create_date)===pk){if(MQL_S.includes(c.lifecycle_stage))out[s].mqls++;if(SQL_S.includes(c.lifecycle_stage))out[s].sqls++;if(c.lifecycle_stage==='customer')out[s].closes++;}});
  meetings.forEach(m=>{
    if(!m.contact_id)return;const s=cMap[m.contact_id];if(!s)return;
    if(!out[s])out[s]={mqls:0,sqls:0,closes:0,mtgs:0,sits:0};
    const d=m.created_date||m.start_time;if(d&&getPeriodKey(d)===pk)out[s].mtgs++;
    if(m.start_time&&getPeriodKey(m.start_time)===pk){const o=(m.outcome||'').toLowerCase().replace(/[_:]/g,' ');if(o.includes('completed')||o.includes('not needed')||o.includes('docs needed'))out[s].sits++;}
  });
  return out;
}
const SRC_COLORS={'Direct mail':'#f59e0b','Direct Mail':'#f59e0b','Meta':'#3b82f6','Google Paid':'#22d3a7','Next Door':'#a855f7','Capital One':'#ec4899','Referrals Program':'#ef4444','LinkedIn':'#06b6d4','Other':'#78716c'};
function getSrcColor(s){return SRC_COLORS[s]||'#'+((Math.abs(s.split('').reduce((a,c)=>((a<<5)-a)+c.charCodeAt(0),0))%0xCCCCCC)+0x333333).toString(16).slice(-6);}
function calcMetricsBySource(periods,key){
  const srcTotals={};
  const perPeriod=periods.map(pk=>{
    let fc=contacts;if(metricScope==='marketing')fc=fc.filter(c=>MARKETING_SOURCES.includes(c.attributed_source));
    const sv=document.getElementById('sourceFilter').value;if(sv!=='all')fc=fc.filter(c=>c.attributed_source===sv);
    const out={};
    fc.forEach(c=>{
      if(!c.create_date||getPeriodKey(c.create_date)!==pk)return;
      const s=c.attributed_source||'Unknown';
      if(key==='mqls'&&MQL_S.includes(c.lifecycle_stage)){out[s]=(out[s]||0)+1;srcTotals[s]=(srcTotals[s]||0)+1;}
      if(key==='sqls'&&SQL_S.includes(c.lifecycle_stage)){out[s]=(out[s]||0)+1;srcTotals[s]=(srcTotals[s]||0)+1;}
    });
    return out;
  });
  const activeSrcs=Object.entries(srcTotals).sort((a,b)=>b[1]-a[1]).map(([s])=>s);
  return activeSrcs.map(s=>({label:sourceLabel(s),data:perPeriod.map(pp=>pp[s]||0),backgroundColor:getSrcColor(s)+'cc',borderColor:getSrcColor(s),borderWidth:1,borderRadius:2}));
}

// ===== SPEND =====
function getSpend(pk){
  const r={};CHANNELS.forEach(c=>r[c]=0);r.total=0;
  let pStart,pEnd;
  if(viewMode==='weekly'){pStart=new Date(pk+'T00:00:00Z');pEnd=new Date(pStart);pEnd.setUTCDate(pEnd.getUTCDate()+7);}
  else{const[y,m]=pk.split('-').map(Number);pStart=new Date(Date.UTC(y,m-1,1));pEnd=new Date(Date.UTC(y,m,1));}

  SPEND_RAW.forEach(d=>{
    const rS=new Date(d.start+'T00:00:00Z'),rE=new Date(d.end+'T00:00:00Z');rE.setUTCDate(rE.getUTCDate()+1);
    const oS=Math.max(pStart.getTime(),rS.getTime()),oE=Math.min(pEnd.getTime(),rE.getTime());
    if(oE>oS){const tot=(rE-rS)/864e5,ov=(oE-oS)/864e5,frac=tot>0?ov/tot:0,amt=d.spend*frac;
      if(r[d.source]!==undefined)r[d.source]+=amt;r.total+=amt;}
  });
  return r;
}

// ===== CHART HELPERS =====
function makeBar(id,labels,vals,color,isCurrency,isPercent){
  if(charts[id])charts[id].destroy();const el=document.getElementById(id);if(!el)return;
  const v=[...vals];const fmt=val=>isPercent?Math.round(val)+'%':isCurrency?'$'+Math.round(val).toLocaleString():val.toLocaleString();
  charts[id]=new Chart(el.getContext('2d'),{type:'bar',data:{labels,datasets:[{data:v,backgroundColor:color+'99',borderColor:color,borderWidth:1,borderRadius:4,barPercentage:.7}]},
    options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{backgroundColor:'#1a2234',titleColor:'#e2e8f0',bodyColor:'#e2e8f0',borderColor:'#1e2d44',borderWidth:1,callbacks:{label:c=>fmt(c.raw)}}},
      layout:{padding:{top:20}},scales:{x:{ticks:{color:'#8896aa',font:{family:'DM Sans',size:10}},grid:{color:'#1e2d44'}},y:{ticks:{color:'#8896aa',font:{family:'Space Mono',size:10},callback:val=>isPercent?val+'%':isCurrency?'$'+val.toLocaleString():val},grid:{color:'#1e2d44'},beginAtZero:true}},
      animation:{onComplete:function(){const ci=this,x=ci.ctx;x.font="bold 11px 'Space Mono',monospace";x.fillStyle='#e2e8f0';x.textAlign='center';x.textBaseline='bottom';
        ci.getDatasetMeta(0).data.forEach((b,i)=>{if(v[i]>0)x.fillText(fmt(v[i]),b.x,b.y-4)})}}
    }});
}

function makeStacked(id,labels,datasets,isCurrency){
  if(charts[id])charts[id].destroy();const el=document.getElementById(id);if(!el)return;
  const cur=isCurrency!==false;
  charts[id]=new Chart(el.getContext('2d'),{type:'bar',data:{labels,datasets},
    options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'top',labels:{color:'#8896aa',font:{family:'DM Sans',size:10},boxWidth:10,padding:8}},
      tooltip:{backgroundColor:'#1a2234',titleColor:'#e2e8f0',bodyColor:'#e2e8f0',borderColor:'#1e2d44',borderWidth:1,callbacks:{label:c=>cur?`${c.dataset.label}: $${Math.round(c.raw).toLocaleString()}`:`${c.dataset.label}: ${c.raw.toLocaleString()}`}}},
      scales:{x:{stacked:true,ticks:{color:'#8896aa',font:{family:'DM Sans',size:10}},grid:{color:'#1e2d44'}},y:{stacked:true,ticks:{color:'#8896aa',font:{family:'Space Mono',size:10},callback:v=>cur?'$'+v.toLocaleString():v.toLocaleString()},grid:{color:'#1e2d44'},beginAtZero:true}}}});
}

function makeHBar(id,srcData,key){
  if(charts[id])charts[id].destroy();const el=document.getElementById(id);if(!el)return;
  const entries=Object.entries(srcData).filter(([,v])=>v[key]>0).sort((a,b)=>b[1][key]-a[1][key]).slice(0,10);
  if(!entries.length){el.getContext('2d').clearRect(0,0,el.width,el.height);return;}
  const colors=['#22d3a7','#3b82f6','#f59e0b','#a855f7','#ec4899','#ef4444','#06b6d4','#84cc16','#f97316','#6b7280'];
  charts[id]=new Chart(el.getContext('2d'),{type:'bar',data:{labels:entries.map(([k])=>sourceLabel(k)),datasets:[{data:entries.map(([,v])=>v[key]),backgroundColor:colors.slice(0,entries.length),borderWidth:0,borderRadius:4,barPercentage:.7}]},
    options:{indexAxis:'y',responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{backgroundColor:'#1a2234',titleColor:'#e2e8f0',bodyColor:'#e2e8f0'}},
      scales:{x:{ticks:{color:'#8896aa',font:{family:'Space Mono',size:10}},grid:{color:'#1e2d44'},beginAtZero:true},y:{ticks:{color:'#8896aa',font:{family:'DM Sans',size:10}},grid:{display:false}}}}});
}

// ===== PIPELINE RENDERERS =====
function renderSummary(){
  const n=viewMode==='weekly'?12:8,periods=[];let k=getCurrentPeriodKey();
  for(let i=0;i<n;i++){periods.unshift(k);k=getPrevKey(k);}
  const data=periods.map(p=>({key:p,...calcMetrics(p)}));
  document.getElementById('summaryTitle').textContent=viewMode==='weekly'?'Pipeline Summary by Week':'Pipeline Summary by Month';
  document.getElementById('summaryHead').innerHTML='<tr><th>Period</th><th>MQLs</th><th>SQLs</th><th>Meetings</th><th>Sits</th><th>Closes (Won)</th><th>MQL‚ÜíSQL</th><th>SQL‚ÜíMtg</th><th>Mtg‚ÜíSit</th><th>Sit‚ÜíClose</th></tr>';
  document.getElementById('summaryBody').innerHTML=data.reverse().map(d=>{
    const r1=d.mqls>0?Math.round((d.sqls/d.mqls)*100)+'%':'‚Äî';
    const r2=d.sqls>0?Math.round((d.mtgs/d.sqls)*100)+'%':'‚Äî';
    const r3=d.mtgs>0?Math.round((d.sits/d.mtgs)*100)+'%':'‚Äî';
    const r4=d.sits>0?Math.round((d.closesDeal/d.sits)*100)+'%':'‚Äî';
    return`<tr><td style="font-family:var(--font);font-weight:600;font-size:13px">${formatPeriod(d.key)}</td><td style="color:#22d3a7;font-weight:700">${d.mqls}</td><td style="color:#3b82f6;font-weight:700">${d.sqls}</td><td style="color:#f59e0b;font-weight:700">${d.mtgs}</td><td style="color:#a855f7;font-weight:700">${d.sits}</td><td style="color:#f43f5e;font-weight:700">${d.closesDeal}</td><td>${r1}</td><td>${r2}</td><td>${r3}</td><td>${r4}</td></tr>`}).join('');
}
function renderTrend(){
  const n=viewMode==='weekly'?12:6,periods=[];let k=getCurrentPeriodKey();
  for(let i=0;i<n;i++){periods.unshift(k);k=getPrevKey(k);}
  const data=periods.map(p=>calcMetrics(p)),labels=periods.map(formatShort);
  [{id:'chartMqls',key:'mqls',c:'#22d3a7'},{id:'chartSqls',key:'sqls',c:'#3b82f6'},{id:'chartMtgs',key:'mtgs',c:'#f59e0b'},{id:'chartSits',key:'sits',c:'#a855f7'},{id:'chartClosesCreated',key:'closesCreated',c:'#ec4899'},{id:'chartClosesDeal',key:'closesDeal',c:'#f43f5e'}]
    .forEach(cfg=>makeBar(cfg.id,labels,data.map(d=>d[cfg.key]),cfg.c,false));
  // Source distribution - stacked column charts for MQLs and SQLs
  const mqlDS=calcMetricsBySource(periods,'mqls');
  makeStacked('srcMqls',labels,mqlDS,false);
  const sqlDS=calcMetricsBySource(periods,'sqls');
  makeStacked('srcSqls',labels,sqlDS,false);
  // Closes and Sits by source (single period horizontal bars)
  const ck=getCurrentPeriodKey(),sd=calcBySource(ck);
  makeHBar('srcCloses',sd,'closes');
  makeHBar('srcSits',sd,'sits');
}

// ===== SPEND RENDERERS =====
function renderSpendKPIs(){
  const ck=getCurrentPeriodKey(),pk=getPrevKey(ck),cs=getSpend(ck),ps=getSpend(pk),cm=calcMetrics(ck),pm=calcMetrics(pk);
  const $=v=>'$'+Math.round(v).toLocaleString();
  const items=[
    {l:'Total Spend',v:cs.total,p:ps.total,inv:false},
    {l:'Cost per MQL',v:cm.mqls?cs.total/cm.mqls:0,p:pm.mqls?ps.total/pm.mqls:0,inv:true},
    {l:'Cost per SQL',v:cm.sqls?cs.total/cm.sqls:0,p:pm.sqls?ps.total/pm.sqls:0,inv:true},
    {l:'Cost per Meeting',v:cm.mtgs?cs.total/cm.mtgs:0,p:pm.mtgs?ps.total/pm.mtgs:0,inv:true},
    {l:'Cost per Sit',v:cm.sits?cs.total/cm.sits:0,p:pm.sits?ps.total/pm.sits:0,inv:true},
    {l:'CAC',v:cm.closesDeal?cs.total/cm.closesDeal:0,p:pm.closesDeal?ps.total/pm.closesDeal:0,inv:true}
  ];
  document.getElementById('spendKpiGrid').innerHTML=items.map(c=>{let ct='‚Äî',cc='flat';
    if(c.p>0){const pct=Math.round(((c.v-c.p)/c.p)*100);ct=pct>0?`+${pct}%`:`${pct}%`;cc=c.inv?(pct>0?'down':pct<0?'up':'flat'):(pct>0?'up':pct<0?'down':'flat');}
    return`<div class="kpi-card"><div class="kpi-label">${c.l}</div><div class="kpi-value" style="font-size:26px">${c.v>0?$(c.v):'‚Äî'}</div><div class="kpi-change ${cc}">${ct}</div><div class="kpi-prev">prev: ${c.p>0?$(c.p):'‚Äî'}</div></div>`}).join('');
}
function renderSpendCharts(){
  const n=viewMode==='weekly'?12:6,periods=[];let k=getCurrentPeriodKey();
  for(let i=0;i<n;i++){periods.unshift(k);k=getPrevKey(k);}
  const labels=periods.map(formatShort),sd=periods.map(p=>getSpend(p)),md=periods.map(p=>calcMetrics(p));

  makeBar('chartSpend',labels,sd.map(s=>Math.round(s.total)),'#22d3a7',true);

  const activeCh=CHANNELS.filter(ch=>sd.some(s=>s[ch]>10));
  makeStacked('chartSpendCh',labels,activeCh.map(ch=>({label:ch,data:sd.map(s=>Math.round(s[ch])),backgroundColor:CH_COLORS[ch]+'cc',borderColor:CH_COLORS[ch],borderWidth:1,borderRadius:2})));

  makeBar('chartCPL',labels,sd.map((s,i)=>md[i].mqls?Math.round(s.total/md[i].mqls):0),'#3b82f6',true);
  makeBar('chartCPSQL',labels,sd.map((s,i)=>md[i].sqls?Math.round(s.total/md[i].sqls):0),'#22d3a7',true);
  makeBar('chartCPM',labels,sd.map((s,i)=>md[i].mtgs?Math.round(s.total/md[i].mtgs):0),'#f59e0b',true);
  makeBar('chartCPS',labels,sd.map((s,i)=>md[i].sits?Math.round(s.total/md[i].sits):0),'#a855f7',true);
  makeBar('chartCAC',labels,sd.map((s,i)=>md[i].closesDeal?Math.round(s.total/md[i].closesDeal):0),'#f43f5e',true);

  // Channel trend (same as stacked but non-stacked)
  makeStacked('chartChTrend',labels,activeCh.map(ch=>({label:ch,data:sd.map(s=>Math.round(s[ch])),backgroundColor:CH_COLORS[ch]+'cc',borderColor:CH_COLORS[ch],borderWidth:1,borderRadius:2})));
}
function renderSpendTable(){
  const n=viewMode==='weekly'?12:6,periods=[];let k=getCurrentPeriodKey();
  for(let i=0;i<n;i++){periods.unshift(k);k=getPrevKey(k);}
  const sd=periods.map(p=>getSpend(p)),md=periods.map(p=>calcMetrics(p));
  const activeCh=CHANNELS.filter(ch=>sd.some(s=>s[ch]>10));
  document.getElementById('spendTableTitle').textContent=viewMode==='weekly'?'Spend & Unit Economics by Week':'Spend & Unit Economics by Month';
  document.getElementById('spendTableHead').innerHTML='<tr><th>Period</th><th>Spend</th>'+activeCh.map(c=>`<th>${c}</th>`).join('')+'<th>MQLs</th><th>SQLs</th><th>Mtgs</th><th>Sits</th><th>Closes</th><th>$/MQL</th><th>$/SQL</th><th>$/Mtg</th><th>$/Sit</th><th>CAC</th></tr>';
  document.getElementById('spendTableBody').innerHTML=periods.map((p,i)=>{
    const s=sd[i],m=md[i],cpl=m.mqls?Math.round(s.total/m.mqls):0,cpsql=m.sqls?Math.round(s.total/m.sqls):0,cpm=m.mtgs?Math.round(s.total/m.mtgs):0,cps=m.sits?Math.round(s.total/m.sits):0,cac=m.closesDeal?Math.round(s.total/m.closesDeal):0;
    return`<tr><td style="font-family:var(--font);font-weight:500;font-size:13px">${formatPeriod(p)}</td><td>$${Math.round(s.total).toLocaleString()}</td>${activeCh.map(c=>`<td>$${Math.round(s[c]).toLocaleString()}</td>`).join('')}<td>${m.mqls}</td><td>${m.sqls}</td><td>${m.mtgs}</td><td>${m.sits}</td><td>${m.closesDeal}</td><td>${cpl?'$'+cpl.toLocaleString():'‚Äî'}</td><td>${cpsql?'$'+cpsql.toLocaleString():'‚Äî'}</td><td>${cpm?'$'+cpm.toLocaleString():'‚Äî'}</td><td>${cps?'$'+cps.toLocaleString():'‚Äî'}</td><td>${cac?'$'+cac.toLocaleString():'‚Äî'}</td></tr>`}).join('');
}

// ===== MEGA SUMMARY =====
let summarySubView='metrics';
function setSummaryView(v,btn){summarySubView=v;document.querySelectorAll('#summarySubToggle button').forEach(b=>b.classList.remove('active'));btn.classList.add('active');
  document.getElementById('summaryMetricsView').style.display=v==='metrics'?'':'none';
  document.getElementById('summaryChartsView').style.display=v==='charts'?'':'none';
  if(v==='charts')renderMegaCharts();
}

function makeMegaGrouped(id,labels,datasets){
  if(charts[id])charts[id].destroy();const el=document.getElementById(id);if(!el)return;
  charts[id]=new Chart(el.getContext('2d'),{type:'bar',data:{labels,datasets},
    options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'top',labels:{color:'#8896aa',font:{family:'DM Sans',size:10},boxWidth:10,padding:8}},
      tooltip:{backgroundColor:'#1a2234',titleColor:'#e2e8f0',bodyColor:'#e2e8f0',borderColor:'#1e2d44',borderWidth:1}},
      scales:{x:{ticks:{color:'#8896aa',font:{family:'DM Sans',size:10}},grid:{color:'#1e2d44'}},y:{ticks:{color:'#8896aa',font:{family:'Space Mono',size:10}},grid:{color:'#1e2d44'},beginAtZero:true}}}});
}

function makeMegaGroupedPct(id,labels,datasets){
  if(charts[id])charts[id].destroy();const el=document.getElementById(id);if(!el)return;
  charts[id]=new Chart(el.getContext('2d'),{type:'bar',data:{labels,datasets},
    options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'top',labels:{color:'#8896aa',font:{family:'DM Sans',size:10},boxWidth:10,padding:8}},
      tooltip:{backgroundColor:'#1a2234',titleColor:'#e2e8f0',bodyColor:'#e2e8f0',borderColor:'#1e2d44',borderWidth:1,callbacks:{label:c=>c.dataset.label+': '+Math.round(c.raw)+'%'}}},
      scales:{x:{ticks:{color:'#8896aa',font:{family:'DM Sans',size:10}},grid:{color:'#1e2d44'}},y:{ticks:{color:'#8896aa',font:{family:'Space Mono',size:10},callback:v=>v+'%'},grid:{color:'#1e2d44'},beginAtZero:true}}}});
}

function makeMegaGroupedCurrency(id,labels,datasets){
  if(charts[id])charts[id].destroy();const el=document.getElementById(id);if(!el)return;
  charts[id]=new Chart(el.getContext('2d'),{type:'bar',data:{labels,datasets},
    options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'top',labels:{color:'#8896aa',font:{family:'DM Sans',size:10},boxWidth:10,padding:8}},
      tooltip:{backgroundColor:'#1a2234',titleColor:'#e2e8f0',bodyColor:'#e2e8f0',borderColor:'#1e2d44',borderWidth:1,callbacks:{label:c=>c.dataset.label+': $'+Math.round(c.raw).toLocaleString()}}},
      scales:{x:{ticks:{color:'#8896aa',font:{family:'DM Sans',size:10}},grid:{color:'#1e2d44'}},y:{ticks:{color:'#8896aa',font:{family:'Space Mono',size:10},callback:v=>'$'+v.toLocaleString()},grid:{color:'#1e2d44'},beginAtZero:true}}}});
}

function getMegaData(){
  const n=viewMode==='weekly'?12:8,periods=[];let k=getCurrentPeriodKey();
  for(let i=0;i<n;i++){periods.unshift(k);k=getPrevKey(k);}
  return{periods,labels:periods.map(formatShort),pipe:periods.map(p=>calcMetrics(p)),site:periods.map(p=>{const s=aggSite(p);return{v:s.v,vqf:s.vqf,cqf:s.cqf,qs:s.qs};}),spend:periods.map(p=>getSpend(p))};
}

function renderMegaCharts(){
  const{labels,pipe,site,spend}=getMegaData();
  const ds=(label,data,color)=>({label,data,backgroundColor:color+'99',borderColor:color,borderWidth:1,borderRadius:4,barPercentage:.25});

  makeMegaGrouped('megaChSiteTraffic',labels,[
    ds('Unique visits',site.map(s=>s.v),'#22d3a7'),
    ds('Started QF',site.map(s=>s.vqf),'#3b82f6'),
    ds('Finished QF',site.map(s=>s.cqf),'#f59e0b'),
  ]);

  makeMegaGroupedPct('megaChSiteConv',labels,[
    ds('Visit ‚Üí Start QF',site.map(s=>s.v>0?Math.round(s.vqf/s.v*100):0),'#3b82f6'),
    ds('Start ‚Üí Finish QF',site.map(s=>s.vqf>0?Math.round(s.cqf/s.vqf*100):0),'#f59e0b'),
    ds('Finish QF ‚Üí Submit',site.map(s=>s.cqf>0?Math.round(s.qs/s.cqf*100):0),'#a855f7'),
  ]);

  makeMegaGrouped('megaChPipeline',labels,[
    ds('MQLs',pipe.map(p=>p.mqls),'#22d3a7'),
    ds('SQLs',pipe.map(p=>p.sqls),'#3b82f6'),
    ds('Meetings',pipe.map(p=>p.mtgs),'#f59e0b'),
    ds('Sits',pipe.map(p=>p.sits),'#a855f7'),
    ds('Closes',pipe.map(p=>p.closesDeal),'#f43f5e'),
  ]);

  makeMegaGroupedPct('megaChConversion',labels,[
    ds('MQL ‚Üí SQL',pipe.map(p=>p.mqls>0?Math.round(p.sqls/p.mqls*100):0),'#22d3a7'),
    ds('SQL ‚Üí Mtg',pipe.map(p=>p.sqls>0?Math.round(p.mtgs/p.sqls*100):0),'#3b82f6'),
    ds('Mtg ‚Üí Sit',pipe.map(p=>p.mtgs>0?Math.round(p.sits/p.mtgs*100):0),'#f59e0b'),
    ds('Sit ‚Üí Close',pipe.map(p=>p.sits>0?Math.round(p.closesDeal/p.sits*100):0),'#f43f5e'),
  ]);

  makeMegaGroupedCurrency('megaChCost',labels,[
    ds('$ / MQL',pipe.map((p,i)=>p.mqls>0?Math.round(spend[i].total/p.mqls):0),'#22d3a7'),
    ds('$ / SQL',pipe.map((p,i)=>p.sqls>0?Math.round(spend[i].total/p.sqls):0),'#3b82f6'),
    ds('$ / Sit',pipe.map((p,i)=>p.sits>0?Math.round(spend[i].total/p.sits):0),'#a855f7'),
    ds('$ / Close',pipe.map((p,i)=>p.closesDeal>0?Math.round(spend[i].total/p.closesDeal):0),'#f43f5e'),
  ]);
}

function renderMegaSummary(){
  const{periods,labels,pipe,site,spend}=getMegaData();
  const n=periods.length;

  document.getElementById('megaTitle').textContent=viewMode==='weekly'?'Weekly Summary':'Monthly Summary';
  document.getElementById('megaHead').innerHTML='<tr><th>Metric</th>'+periods.map(p=>`<th>${formatShort(p)}</th>`).join('')+'</tr>';

  const pct=(a,b)=>b>0?Math.round(a/b*100)+'%':'‚Äî';
  const $=v=>v>0?'$'+Math.round(v).toLocaleString():'‚Äî';

  const sections=[
    {title:'Site Traffic',rows:[
      {label:'Unique website visits',vals:site.map(s=>s.v.toLocaleString())},
      {label:'Started quote flow',vals:site.map(s=>s.vqf.toLocaleString())},
      {label:'Finished quote flow',vals:site.map(s=>s.cqf.toLocaleString())},
    ]},
    {title:'Site Conversion',rows:[
      {label:'Site visit ‚Üí Start QF',vals:site.map(s=>pct(s.vqf,s.v))},
      {label:'Start ‚Üí Finish QF',vals:site.map(s=>pct(s.cqf,s.vqf))},
      {label:'Finish QF ‚Üí Submit info',vals:site.map(s=>pct(s.qs,s.cqf))},
    ]},
    {title:'Marketing & Sales',rows:[
      {label:'MQLs',vals:pipe.map(p=>p.mqls.toLocaleString())},
      {label:'SQLs',vals:pipe.map(p=>p.sqls.toLocaleString())},
      {label:'Meetings',vals:pipe.map(p=>p.mtgs.toLocaleString())},
      {label:'Sits',vals:pipe.map(p=>p.sits.toLocaleString())},
      {label:'Closes',vals:pipe.map(p=>p.closesDeal.toLocaleString())},
    ]},
    {title:'Conversion Metrics',rows:[
      {label:'MQL ‚Üí SQL',vals:pipe.map(p=>pct(p.sqls,p.mqls))},
      {label:'SQL ‚Üí Meetings',vals:pipe.map(p=>pct(p.mtgs,p.sqls))},
      {label:'Meeting ‚Üí Sits',vals:pipe.map(p=>pct(p.sits,p.mtgs))},
      {label:'Sits ‚Üí Closed',vals:pipe.map(p=>pct(p.closesDeal,p.sits))},
    ]},
    {title:'Cost Metrics',rows:[
      {label:'Total Spend',vals:spend.map(s=>$(s.total))},
      {label:'$ / MQL',vals:periods.map((_,i)=>pipe[i].mqls>0?$(spend[i].total/pipe[i].mqls):'‚Äî')},
      {label:'$ / SQL',vals:periods.map((_,i)=>pipe[i].sqls>0?$(spend[i].total/pipe[i].sqls):'‚Äî')},
      {label:'$ / Sit',vals:periods.map((_,i)=>pipe[i].sits>0?$(spend[i].total/pipe[i].sits):'‚Äî')},
      {label:'$ / Close',vals:periods.map((_,i)=>pipe[i].closesDeal>0?$(spend[i].total/pipe[i].closesDeal):'‚Äî')},
    ]},
  ];

  let html='';
  sections.forEach(sec=>{
    html+=`<tr class="section-row"><td colspan="${n+1}">${sec.title}</td></tr>`;
    sec.rows.forEach(row=>{
      html+=`<tr><td>${row.label}</td>${row.vals.map(v=>`<td>${v}</td>`).join('')}</tr>`;
    });
  });
  document.getElementById('megaBody').innerHTML=html;

  if(summarySubView==='charts')renderMegaCharts();
}

// ===== SITE CONVERSION =====
let siteData=SITE_RAW;
let siteDevFilter='all';

function setSiteDev(d,btn){siteDevFilter=d;document.querySelectorAll('#siteDeviceToggle button').forEach(b=>b.classList.remove('active'));btn.classList.add('active');renderSite();}

function aggSite(pk){
  // pk is week key (YYYY-MM-DD) or month key (YYYY-MM)
  const r={v:0,vqf:0,cqf:0,qs:0,mv:0,mvqf:0,mcqf:0,mqs:0,dv:0,dvqf:0,dcqf:0,dqs:0};
  siteData.forEach(d=>{
    const dk=d[0];
    let match=false;
    if(viewMode==='weekly'){const ws=getWeekStart(new Date(dk+'T00:00:00Z')).toISOString().split('T')[0];match=ws===pk;}
    else{match=dk.substring(0,7)===pk;}
    if(!match)return;
    r.v+=d[1];r.vqf+=d[2];r.cqf+=d[3];r.qs+=d[4];
    r.mv+=d[5];r.mvqf+=d[6];r.mcqf+=d[7];r.mqs+=d[8];
    r.dv+=d[9];r.dvqf+=d[10];r.dcqf+=d[11];r.dqs+=d[12];
  });
  return r;
}

function getSiteMetrics(s){
  if(siteDevFilter==='M')return{v:s.mv,vqf:s.mvqf,cqf:s.mcqf,qs:s.mqs};
  if(siteDevFilter==='D')return{v:s.dv,vqf:s.dvqf,cqf:s.dcqf,qs:s.dqs};
  return{v:s.v,vqf:s.vqf,cqf:s.cqf,qs:s.qs};
}

function renderSite(){
  const n=viewMode==='weekly'?12:8,periods=[];let k=getCurrentPeriodKey();
  for(let i=0;i<n;i++){periods.unshift(k);k=getPrevKey(k);}
  const raw=periods.map(p=>aggSite(p)),data=raw.map(s=>getSiteMetrics(s));
  const labels=periods.map(formatShort);

  // Summary table
  document.getElementById('siteTableTitle').textContent=viewMode==='weekly'?'Site Conversion by Week':'Site Conversion by Month';
  document.getElementById('siteTableHead').innerHTML='<tr><th>Period</th><th>Visits</th><th>Started QF</th><th>Finished QF</th><th>Requests</th><th>Visit‚ÜíStart QF</th><th>QF‚ÜíFinish QF</th><th>Finish QF‚ÜíRequest</th></tr>';
  document.getElementById('siteTableBody').innerHTML=[...data].reverse().map((d,i)=>{
    const pi=data.length-1-i;
    const r1=d.v>0?(d.vqf/d.v*100).toFixed(1)+'%':'‚Äî';
    const r2=d.vqf>0?(d.cqf/d.vqf*100).toFixed(1)+'%':'‚Äî';
    const r3=d.cqf>0?(d.qs/d.cqf*100).toFixed(1)+'%':'‚Äî';
    return`<tr><td style="font-family:var(--font);font-weight:600;font-size:13px">${formatPeriod(periods[pi])}</td><td style="color:#22d3a7;font-weight:700">${d.v.toLocaleString()}</td><td style="color:#3b82f6;font-weight:700">${d.vqf.toLocaleString()}</td><td style="color:#f59e0b;font-weight:700">${d.cqf.toLocaleString()}</td><td style="color:#a855f7;font-weight:700">${d.qs.toLocaleString()}</td><td>${r1}</td><td>${r2}</td><td>${r3}</td></tr>`}).join('');

  // Volume charts
  makeBar('chartSiteVisits',labels,data.map(d=>d.v),'#22d3a7',false);
  makeBar('chartSiteVQF',labels,data.map(d=>d.vqf),'#3b82f6',false);
  makeBar('chartSiteCQF',labels,data.map(d=>d.cqf),'#f59e0b',false);
  makeBar('chartSiteQRS',labels,data.map(d=>d.qs),'#a855f7',false);

  // Conversion rate charts
  makeBar('chartSiteR1',labels,data.map(d=>d.v>0?Math.round(d.vqf/d.v*100):0),'#3b82f6',false,true);
  makeBar('chartSiteR2',labels,data.map(d=>d.vqf>0?Math.round(d.cqf/d.vqf*100):0),'#f59e0b',false,true);
  makeBar('chartSiteR3',labels,data.map(d=>d.cqf>0?Math.round(d.qs/d.cqf*100):0),'#a855f7',false,true);

  // Mobile vs Desktop comparison - stacked bar of Visit‚ÜíQF conversion
  const mData=raw.map(s=>s.mv>0?Math.round(s.mvqf/s.mv*1000)/10:0);
  const dData=raw.map(s=>s.dv>0?Math.round(s.dvqf/s.dv*1000)/10:0);
  if(charts['chartSiteMD'])charts['chartSiteMD'].destroy();
  const el=document.getElementById('chartSiteMD');if(el){
    charts['chartSiteMD']=new Chart(el.getContext('2d'),{type:'bar',data:{labels,datasets:[
      {label:'Mobile',data:mData,backgroundColor:'#a855f799',borderColor:'#a855f7',borderWidth:1,borderRadius:4,barPercentage:.35},
      {label:'Desktop',data:dData,backgroundColor:'#3b82f699',borderColor:'#3b82f6',borderWidth:1,borderRadius:4,barPercentage:.35}
    ]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'top',labels:{color:'#8896aa',font:{family:'DM Sans',size:10},boxWidth:10}},
      tooltip:{backgroundColor:'#1a2234',titleColor:'#e2e8f0',bodyColor:'#e2e8f0',borderColor:'#1e2d44',borderWidth:1,callbacks:{label:c=>c.dataset.label+': '+c.raw+'%'}}},
      scales:{x:{ticks:{color:'#8896aa',font:{family:'DM Sans',size:10}},grid:{color:'#1e2d44'}},y:{ticks:{color:'#8896aa',font:{family:'Space Mono',size:10},callback:v=>v+'%'},grid:{color:'#1e2d44'},beginAtZero:true}}}});
  }
}

function handleSiteUpload(e){
  const file=e.target.files[0];if(!file)return;
  const reader=new FileReader();
  reader.onload=function(ev){
    const lines=ev.target.result.split('\n');
    const daily={},daily_dev={};
    for(let i=1;i<lines.length;i++){
      const cols=lines[i].split(',');if(cols.length<8)continue;
      const dt=cols[0].trim(),dev=cols[1].trim();
      if(!/^\d{4}-\d{2}-\d{2}$/.test(dt))continue;
      if(parseInt(dt.substring(0,4))<2024)continue;
      const v=parseInt(cols[2])||0,vqf=parseInt(cols[3])||0,cqf=parseInt(cols[6])||0,qs=parseInt(cols[7])||0;
      const dk=dev==='Mobile'?'M':dev==='Desktop'?'D':null;
      if(!daily[dt])daily[dt]=[0,0,0,0];
      daily[dt][0]+=v;daily[dt][1]+=vqf;daily[dt][2]+=cqf;daily[dt][3]+=qs;
      if(dk){const key=dt+'_'+dk;if(!daily_dev[key])daily_dev[key]=[0,0,0,0];daily_dev[key][0]+=v;daily_dev[key][1]+=vqf;daily_dev[key][2]+=cqf;daily_dev[key][3]+=qs;}
    }
    const newData=[];
    Object.keys(daily).sort().forEach(dt=>{
      const t=daily[dt],m=daily_dev[dt+'_M']||[0,0,0,0],d=daily_dev[dt+'_D']||[0,0,0,0];
      newData.push([dt,...t,...m,...d]);
    });
    siteData=newData;
    renderSite();
    e.target.value='';
    alert('Site conversion data updated: '+newData.length+' days loaded');
  };
  reader.readAsText(file);
}

// ===== MAIN =====
function refresh(){
  const ck=getCurrentPeriodKey(),pk=getPrevKey(ck);
  document.getElementById('periodLabel').textContent=formatPeriod(ck);
  if(activeTab==='summary'){renderMegaSummary();}
  else if(activeTab==='pipeline'){renderSummary();renderTrend();}
  else if(activeTab==='spend'){renderSpendKPIs();renderSpendCharts();renderSpendTable();}
  else if(activeTab==='site'){renderSite();}
}
function setTab(t,btn){activeTab=t;document.querySelectorAll('#tabToggle button').forEach(b=>b.classList.remove('active'));btn.classList.add('active');
  document.querySelectorAll('.tab-content').forEach(el=>el.classList.remove('active'));
  const tabMap={summary:'tabSummary',pipeline:'tabPipeline',spend:'tabSpend',site:'tabSite'};
  document.getElementById(tabMap[t]).classList.add('active');refresh();}
function setView(m){viewMode=m;periodOffset=0;document.querySelectorAll('#periodToggle button').forEach(b=>b.classList.remove('active'));event.target.classList.add('active');refresh();}
function navigatePeriod(d){periodOffset+=d;refresh();}

loadData();
</script>
</body>
</html>
